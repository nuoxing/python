<!DOCTYPE html>   
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]> <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]> <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]> <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="zh-CN" prefix="og: http://ogp.me/ns#" class="no-js"> <!--<![endif]-->


<!-- BEGIN head -->
<head>

	<!-- Title -->
	<title>scrapy学习笔记 - Python - 伯乐在线</title>
	
	<!-- Meta Tags -->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	
	<!-- Favicon & Mobileicon -->
	<link rel="shortcut icon" href="http://python.jobbole.com/wp-content/uploads/sites/13/2014/12/favicon.png" />
	<link rel="apple-touch-icon" href="http://python.jobbole.com/wp-content/themes/jobboleblogv3/mobileicon.png" />
	
	<!-- RSS, Atom & Pingbacks -->
		<link rel="alternate" title="Python &#8211; 伯乐在线 RSS Feed" href="http://python.jobbole.com/feed/" />
		<link rel="alternate" title="RSS .92" href="http://python.jobbole.com/feed/rss/" />
	<link rel="alternate" title="Atom 0.3" href="http://python.jobbole.com/feed/atom/" />
	<link rel="pingback" href="http://python.jobbole.com/xmlrpc.php" />
	
	<!-- Theme Hook -->
	
<!-- This site is optimized with the Yoast WordPress SEO plugin v1.4.13 - http://yoast.com/wordpress/seo/ -->
<meta name="description" content="scrapy是python最有名的爬虫框架之一，可以很方便的进行web抓取，并且提供了很强的定制型，这里记录简单学习的过程和在实际应用中会遇到的一些常见问题"/>
<link rel="canonical" href="http://python.jobbole.com/86584/" />
<meta property='og:locale' content='zh_CN'/>
<meta property='og:type' content='article'/>
<meta property='og:title' content='scrapy学习笔记 - Python - 伯乐在线'/>
<meta property='og:description' content='scrapy是python最有名的爬虫框架之一，可以很方便的进行web抓取，并且提供了很强的定制型，这里记录简单学习的过程和在实际应用中会遇到的一些常见问题'/>
<meta property='og:url' content='http://python.jobbole.com/86584/'/>
<meta property='og:site_name' content='Python - 伯乐在线'/>
<meta property='og:image' content='http://jbcdn2.b0.upaiyun.com/2016/10/c24dade2ab6bc0143a2abc9d271136d0.png'/>
<!-- / Yoast WordPress SEO plugin. -->

<link rel='stylesheet' id='dashicons-css'  href='http://python.jobbole.com/wp-includes/css/dashicons.min.css?ver=4.5.13' type='text/css' media='all' />
<link rel='stylesheet' id='thickbox-css'  href='http://python.jobbole.com/wp-includes/js/thickbox/thickbox.css?ver=4.5.13' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox-css-css'  href='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/css/jquery.fancybox.css?ver=2.1.5' type='text/css' media='all' />
<link rel='stylesheet' id='jobbole-wp-css-css'  href='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/css/jobbole-wp-plugin.css?ver=1.0.30' type='text/css' media='all' />
<link rel='stylesheet' id='crayon_colorbox_css-css'  href='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/util/tag-editor/colorbox/colorbox.css?ver=2.7.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon_style-css'  href='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/src/crayon_style.css?ver=2.7.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon_global_style-css'  href='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/css/src/global_style.css?ver=2.7.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-github-css'  href='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/themes/github/github.css?ver=2.7.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=2.7.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='v48fv_images-css'  href='http://python.jobbole.com/wp-content/plugins/mu-widgets/library/base/public/css/images.css?ver=1.2.v48fv' type='text/css' media='all' />
<link rel='stylesheet' id='v48fv_front-css'  href='http://python.jobbole.com/wp-content/plugins/mu-widgets/library/base/public/css/front.css?ver=1.2.v48fv' type='text/css' media='all' />
<link rel='stylesheet' id='v48fv_common-css'  href='http://python.jobbole.com/wp-content/plugins/mu-widgets/library/base/public/css/common.css?ver=1.2.v48fv' type='text/css' media='all' />
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/js/jquery.fancybox.pack.js?ver=2.1.5'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/js/superfish.js?ver=1.4.8'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/js/menu-effects.js?ver=1.5.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var JobboleAjax = {"ajaxurl":"http:\/\/python.jobbole.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/jobbole-wp-plugin/js/jobbole-wp-plugin.js?ver=1.0.61'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/util/tag-editor/colorbox/jquery.colorbox-min.js?ver=2.7.1.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"2.7.1.1","is_admin":"0","ajaxurl":"http:\/\/python.jobbole.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"\u4f7f\u7528 %s \u590d\u5236\uff0c\u4f7f\u7528 %s \u7c98\u8d34\u3002","minimize":"\u70b9\u51fb\u5c55\u5f00\u4ee3\u7801"};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/js/src/util.js?ver=2.7.1.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var CrayonTagEditorSettings = {"home_url":"http:\/\/python.jobbole.com","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button_generic":".mce-btn","tinymce_button":"a.mce_crayon_tinymce,.mce-i-crayon_tinymce","tinymce_button_unique":"mce_crayon_tinymce","tinymce_highlight":"mce-active","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"python","add_text":"Add Code","edit_text":"Edit Code","quicktag_text":"crayon","submit_add":"\u63d2\u5165","submit_edit":"\u4fdd\u5b58","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","psc":"papyrus","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/util/tag-editor/crayon_tag_editor.js?ver=2.7.1.1'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/js/src/jquery.popup.js?ver=2.7.1.1'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/js/src/crayon.js?ver=2.7.1.1'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/modernizr.js?ver=2.5.3'></script>
<link rel='https://api.w.org/' href='http://python.jobbole.com/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://python.jobbole.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://python.jobbole.com/wp-includes/wlwmanifest.xml" /> 
<link rel='shortlink' href='http://python.jobbole.com/?p=86584' />
<link rel="alternate" type="application/json+oembed" href="http://python.jobbole.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" />
<link rel="alternate" type="text/xml+oembed" href="http://python.jobbole.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F&#038;format=xml" />
    <script type="text/javascript">
        jQuery(function($){
            $('.comment-reply-link').click(function(e){
                e.preventDefault();
                var args = $(this).data('onclick');
                args = args.replace(/.*\(|\)/gi, '').replace(/\"|\s+/g, '');
                args = args.split(',');
                tinymce.EditorManager.execCommand('mceRemoveEditor', true, 'comment_editor');
                addComment.moveForm.apply( addComment, args );
                tinymce.EditorManager.execCommand('mceAddEditor', true, 'comment_editor');
            });

            $('#cancel-comment-reply-link').click(function(e){
                e.preventDefault();
                tinymce.EditorManager.execCommand('mceRemoveEditor', true, 'comment_editor');
                tinymce.EditorManager.execCommand('mceAddEditor', true, 'comment_editor');
            });
        });
    </script>
	
	<!-- CSS -->
    <link rel="stylesheet" type="text/css" media="screen" href="http://python.jobbole.com/wp-content/themes/jobboleblogv3/style.css?ver=1.0.66">
	<style>
				*::selection { background: #0099cc; }
		*::-moz-selection { background: #0099cc; }
		body {
            background: #ffffff         }

        a,
        .tabs ul.nav li a:hover,
        .tabs ul.nav li.active a,
        .dropcap,
        .toggle.hover .toggle-title,
        li.comment cite a:hover,
        h3.widget-title,
        .post-meta .meta-title:hover,
        .the-latest a:hover h4,
        .aw_socialcounter_widget li a:hover,
        .aw_tabbed_widget #tab-latest-comments a:hover
        {
            color: #0099cc;
        }

		a:hover { color: #b30000; }
		input:focus, textarea:focus { border-color: #0099cc; }

		#searchsubmit,
        .highlight,
        .aw_tabbed_widget .tabs ul.nav li.active a, footer .aw_tabbed_widget .tabs ul.nav li.active a,
        #top .aw_tabbed_widget .tabs ul.nav li.active a,
        .aw_tabbed_widget .tabs ul.nav li a:hover,
        footer .aw_tabbed_widget .tabs ul.nav li a:hover,
        #top .aw_tabbed_widget .tabs ul.nav li a:hover,
        .aw_twitter_widget .twitter-icon, .testimonial-icon,
        #top-closed:hover,
        .flex-control-nav a:hover,
        .flex-control-nav a.flex-active {
            background-color: #0099cc;
        }

		.submit { background-color: #0099cc; border-color: #007399; }
		.submit:hover { background-color: #b30000; border-color: #860000; }
		#searchsubmit:hover { background-color: #b30000; }
		.toggle.hover .toggle-icon { border-top-color: #0099cc; }
		.toggle.hover.active .toggle-icon { border-bottom-color: #0099cc; }
		.flex-direction-nav li .flex-prev:hover { border-right-color: #0099cc; }
		.flex-direction-nav li .flex-next:hover { border-left-color: #0099cc; }
		@media only screen and (min-width: 768px) and (max-width: 959px) {
			.aw_tabbed_widget .tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
		@media screen and (max-width: 767px) {
			.tabs ul.nav li a:hover, .tabs ul.nav li.active a { color: #0099cc; }
		}
	</style>

	<!--[if IE 8]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
    <![endif]-->

	<!-- Links: RSS + Atom Syndication + Pingback etc. -->
	<link rel="alternate" type="application/rss+xml" title="Python &#8211; 伯乐在线 RSS Feed" href="http://python.jobbole.com/feed/" />
	<link rel="alternate" type="text/xml" title="RSS .92" href="http://python.jobbole.com/feed/rss/" />
	<link rel="alternate" type="application/atom+xml" title="Atom 0.3" href="http://python.jobbole.com/feed/atom/" />
	<link rel="pingback" href="http://python.jobbole.com/xmlrpc.php" />

<!-- END head -->
</head>

<!-- BEGIN body -->
<body class="single single-post postid-86584 single-format-standard unknown">

		
	    <nav id="top-nav" class="menu-nav">

        <!-- BEGIN .container -->
        <div class="container">

            <div class="grid-7 hide-on-480 hide-on-767">
                <ul id="menu-main-menu" class="menu left">
                    <li class="menu-item">
                        <a href="http://www.jobbole.com">首页</a>
                    </li>
                    <li class="menu-item">
                        <a href="http://top.jobbole.com">资讯</a>
                    </li>
                    <li class="menu-item">
                        <span><a href="http://blog.jobbole.com">文章 <i class="fa fa-angle-double-down"></i></a></span>
                        <ul class="sub-menu sf-js-enabled">
                            <li class="menu-item"><a href="http://blog.jobbole.com">全部文章</a></li>
                            <li class="menu-item"><a href="http://web.jobbole.com">Web前端</a></li>
                            <li class="menu-item"><a href="http://python.jobbole.com">Python开发</a></li>
                            <li class="menu-item"><a href="http://www.importnew.com/?utm_source=home-top-nav">Java技术</a></li>
                            <li class="menu-item"><a href="http://android.jobbole.com">Android应用</a></li>
                            <li class="menu-item"><a href="http://ios.jobbole.com">iOS应用</a></li>
                        </ul>
                    </li>
                    <li class="menu-item">
                        <a href="http://hao.jobbole.com">资源</a>
                    </li>

                    <li class="menu-item">
                        <a href="http://group.jobbole.com">小组</a>
                    </li>

                    <li class="menu-item">
                        <a href="http://date.jobbole.com"><i class="fa fa-heart-o pinkiconcolor"></i> 相亲</a>
                    </li>
                </ul>
            </div>

            <div class="grid-5">
                <ul id="menu-main-menu" class="menu">
                    <li class="menu-item hide-on-768-wider left">
                        <span><a href="#">频道 <i class="fa fa-angle-double-down"></i></a></span>
                        <ul class="sub-menu sf-js-enabled">
                            <li class="menu-item"><a href="http://www.jobbole.com">首页</a></li>
                            <li class="menu-item"><a href="http://top.jobbole.com">资讯</a></li>
                            <li class="menu-item"><a href="http://group.jobbole.com">小组</a></li>
                            <li class="menu-item"><a href="http://date.jobbole.com">相亲 <i class="fa fa-heart-o pinkiconcolor"></i></a></li>
                            <li class="menu-item"><a href="http://hao.jobbole.com">资源</a></li>
                            <li class="menu-item"><a href="http://blog.jobbole.com">全部文章</a></li>
                            <li class="menu-item"><a href="http://web.jobbole.com">前端</a></li>
                            <li class="menu-item"><a href="http://python.jobbole.com">Python</a></li>
                            <li class="menu-item"><a href="http://www.importnew.com/">Java</a></li>
                            <li class="menu-item"><a href="http://android.jobbole.com">安卓</a></li>
                            <li class="menu-item"><a href="http://ios.jobbole.com">iOS</a></li>
                        </ul>
                    </li>

                                            <li class="menu-item"><a href="http://www.jobbole.com/login?redirect=http%3A%2F%2Fpython.jobbole.com%2F86584%2F"><i class="fa fa-sign-in"></i> 登录</a></li>
                        <li class="menu-item"><a href="http://www.jobbole.com/register"><i class="fa fa-user-plus"></i> 注册</a></li>
                    
                    
                    <li class="menu-item"><a title="帮助" href="http://blog.jobbole.com/87622/"><i class="fa fa-question-circle fa-lg"></i></a></li>
                </ul>
            </div>
            <div class="clear"></div>

        </div>
        <!-- END .container -->

    </nav>
    <!-- END #top-nav -->
  	
	<!-- BEGIN #wrapper -->
	<div id="wrapper" class="container">

		<!-- BEGIN header -->
		<header>
		
						
			<div class="header-wrapper">
								
				<!-- BEGIN #logo -->
				<div id="logo" class="leaderboard-true">
                    <a href="http://python.jobbole.com"><img src="http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/img/jobbole-logo.png" alt="Python &#8211; 伯乐在线" /></a>
				</div>
				<!-- END #logo -->
				
				<!-- BEGIN #leaderboard -->
				<div id="leaderboard">
				
					<a href='http://date.jobbole.com/4164/' target='_blank'><img width='728' height='90' src='http://wx2.sinaimg.cn/mw690/bfdcef89gy1ffimc8bgf3j20k802i3zn.jpg' /></a>				
				</div>
				<!-- END #leaderboard -->
				
				<div class="clear"></div>
			
			</div>
			
						
			<div class="clear"></div>

            			<!-- BEGIN #main-nav -->
			<nav id="main-nav" class="grid-12 menu-nav">
                <div class="menu-sub-menu-container"><ul id="main-nav-menu" class="menu"><li id="menu-item-80741" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-80741"><a href="http://python.jobbole.com/">首页</a></li>
<li id="menu-item-80740" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-80740"><a href="http://python.jobbole.com/all-posts/">所有文章</a></li>
<li id="menu-item-83414" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83414"><a href="http://python.jobbole.com/category/news/">观点与动态</a></li>
<li id="menu-item-83410" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83410"><a href="http://python.jobbole.com/category/basic/">基础知识</a></li>
<li id="menu-item-83411" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83411"><a href="http://python.jobbole.com/category/guide/">系列教程</a></li>
<li id="menu-item-83412" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-83412"><a href="http://python.jobbole.com/category/project/">实践项目</a></li>
<li id="menu-item-83413" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-83413"><a href="http://python.jobbole.com/category/tools/">工具与框架</a></li>
<li id="menu-item-80742" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-80742"><a href="http://hao.jobbole.com/?catid=144">工具资源</a></li>
<li id="menu-item-85851" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-85851"><a href="http://group.jobbole.com/category/tech/python/">Python小组</a></li>
</ul></div>				<div class="clear"></div>
			</nav>
			<!-- END #main-nav -->
                        <div class="clear"></div>

		</header>
		<!-- END header -->
		
		<div id="breadcrumb" class="grid-12 margin-20"><div class="breadcrumb-wrapper"><!-- Breadcrumb NavXT 4.4.0 -->
<a title="Go to 伯乐在线." href="http://www.jobbole.com" class="main-home">伯乐在线</a> &gt; <a title="Go to Python - 伯乐在线." href="http://python.jobbole.com" class="home">Python - 伯乐在线</a> &gt; <a title="Go to 所有文章." href="http://python.jobbole.com/all-posts/" class="post-root post-post">所有文章</a> &gt; <a title="Go to the 工具与框架 category archives." href="http://python.jobbole.com/category/tools/" class="category">工具与框架</a> &gt; scrapy学习笔记</div></div><div class="clear"></div>

<!-- BEGIN .grid-8 -->
<div class="grid-8">

		
	<!-- BEGIN .post -->
<div class="post-86584 post type-post status-publish format-standard hentry category-tools tag-scrapy odd" id="post-86584">
	
	<!-- BEGIN .entry-header -->
	<div class="entry-header">
	
				
		<h1>scrapy学习笔记</h1>
		
							
	</div>
	<!-- BEGIN .entry-header -->
	
	<!-- BEGIN .entry-meta -->
	<div class="entry-meta">
	
		<p class="entry-meta-hide-on-mobile">

            2016/10/12 &middot;  <a href="http://python.jobbole.com/category/tools/" rel="category tag">工具与框架</a>
            
                            &middot; <a href="#article-comment"> 5 评论 </a>
            

            
             &middot;  <a href="http://python.jobbole.com/tag/scrapy/">Scrapy</a>
            
</p>

<!-- JiaThis Button BEGIN -->
<div class="jiathis_style" style="display: block; margin: 0 0px; clear: both;"><span class="jiathis_txt">分享到：</span>
<a class="jiathis_button_tsina"></a>
<a class="jiathis_button_weixin"></a>
<a class="jiathis_button_qzone"></a>
<a class="jiathis_button_fb"></a>
<a class="jiathis_button_douban"></a>
<a class="jiathis_button_readitlater"></a>
<a class="jiathis_button_evernote"></a>
<a class="jiathis_button_ydnote"></a>
<a href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
<a class="jiathis_counter_style"></a>
</div>
<!-- JiaThis Button END -->


	</div>
	<!-- END .entry-meta -->

	<!-- BEGIN .entry -->
	<div class="entry">

        
		<div class='copyright-area'>原文出处： <a target='_blank' href='https://segmentfault.com/a/1190000007073049'>bomo</a>&nbsp;&nbsp;&nbsp;</div><p>scrapy是python最有名的爬虫框架之一，可以很方便的进行web抓取，并且提供了很强的定制型，这里记录简单学习的过程和在实际应用中会遇到的一些常见问题</p>
<div>
<h2>一、安装</h2>
<p>在安装scrapy之前有一些依赖需要安装，否则可能会安装失败，scrapy的选择器依赖于<code>lxml</code>，还有<code>Twisted</code>网络引擎，下面是ubuntu下安装的过程</p>
<h3>1. linux下安装</h3>
<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd2c660770306" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
# 1. 安装xml依赖库
$ sudo apt-get install libxml2 libxml2-dev
$ sudo apt-get install libxslt1-dev
$ sudo apt-get install python-libxml2

# 2. 安装lxml
$ sudo pip install lxml

# 3. 安装Twisted（版本可以换成最新的），用pip也可以，如果失败的话下载源码安装，如下
$ wget https://pypi.python.org/packages/6b/23/8dbe86fc83215015e221fbd861a545c6ec5c9e9cd7514af114d1f64084ab/Twisted-16.4.1.tar.bz2#md5=c6d09bdd681f538369659111f079c29d
$ tar xjf Twisted-16.4.1.tar.bz2
$ cd Twisted-16.4.1
$ sudo python setup.py install

# 3. 安装scrapy
$ sudo pip install scrapy</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd2c660770306-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd2c660770306-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-1"><span class="crayon-p"># 1. 安装xml依赖库</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-e">libxml2 </span><span class="crayon-v">libxml2</span><span class="crayon-o">-</span><span class="crayon-i">dev</span></div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-3"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">libxslt1</span><span class="crayon-o">-</span><span class="crayon-i">dev</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-4"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-v">apt</span><span class="crayon-o">-</span><span class="crayon-e">get </span><span class="crayon-e">install </span><span class="crayon-v">python</span><span class="crayon-o">-</span><span class="crayon-v">libxml2</span></div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-6"><span class="crayon-p"># 2. 安装lxml</span></div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-7"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">lxml</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-8">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-9"><span class="crayon-p"># 3. 安装Twisted（版本可以换成最新的），用pip也可以，如果失败的话下载源码安装，如下</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-10"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">wget </span><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//pypi.python.org/packages/6b/23/8dbe86fc83215015e221fbd861a545c6ec5c9e9cd7514af114d1f64084ab/Twisted-16.4.1.tar.bz2#md5=c6d09bdd681f538369659111f079c29d</span></div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-11"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">tar </span><span class="crayon-e">xjf </span><span class="crayon-v">Twisted</span><span class="crayon-o">-</span><span class="crayon-cn">16.4.1.tar.bz2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-12"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">cd </span><span class="crayon-v">Twisted</span><span class="crayon-o">-</span><span class="crayon-cn">16.4.1</span></div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-13"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-e">python </span><span class="crayon-v">setup</span><span class="crayon-sy">.</span><span class="crayon-e">py </span><span class="crayon-v">install</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-14">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd2c660770306-15"><span class="crayon-p"># 3. 安装scrapy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd2c660770306-16"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">sudo </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">scrapy</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p></p>
<blockquote><p><a href="http://lxml.de/installation.html">http://lxml.de/installation.html</a></p></blockquote>
<h3>2. Mac下安装</h3>
<p></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd37752399648" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
# 安装xml依赖库
$ xcode-select —install

# 其实相关依赖pip会自动帮我们装上
$ pip install scrapy</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd37752399648-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd37752399648-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd37752399648-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd37752399648-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd37752399648-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd37752399648-1"><span class="crayon-p"># 安装xml依赖库</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd37752399648-2"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">xcode</span><span class="crayon-o">-</span><span class="crayon-i">select</span><span class="crayon-h"> </span>—<span class="crayon-v">install</span></div><div class="crayon-line" id="crayon-5aa2982a5bd37752399648-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd37752399648-4"><span class="crayon-p"># 其实相关依赖pip会自动帮我们装上</span></div><div class="crayon-line" id="crayon-5aa2982a5bd37752399648-5"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">scrapy</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p>mac下安装有时候会失败，建议使用<code>virtualenv</code>安装在独立的环境下，可以减少一些问题，因为mac系统自带python，例如一些依赖库依赖的一些新的版本，而升级新版本会把旧版本卸载掉，卸载可能会有权限的问题</p>
<h2>二、基本使用</h2>
<h3>1. 初始化scrapy项目</h3>
<p>我们可以使用命令行初始化一个项目</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd3b480306457" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
$ scrapy startproject tutorial</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd3b480306457-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd3b480306457-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">scrapy </span><span class="crayon-e">startproject </span><span class="crayon-v">tutorial</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<blockquote><p><a href="https://scrapy-chs.readthedocs.io/zh_CN/0.24/topics/commands.html">这里</a>可以查看scrapy更多其他的命令</p></blockquote>
<p>初始化完成后，我们得到下面目录结构</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd3f912459819" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
scrapy.cfg:         项目的配置文件
tutorial/:          该项目的python模块, 在这里添加代码
    items.py:       项目中的item文件
    pipelines.py:   项目中的pipelines文件.
    settings.py:    项目全局设置文件.
    spiders/        爬虫模块目录</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd3f912459819-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd3f912459819-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd3f912459819-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd3f912459819-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd3f912459819-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd3f912459819-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd3f912459819-1"><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">cfg</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>项目的配置文件</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd3f912459819-2"><span class="crayon-v">tutorial</span><span class="crayon-o">/</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>该项目的<span class="crayon-i">python</span>模块<span class="crayon-sy">,</span><span class="crayon-h"> </span>在这里添加代码</div><div class="crayon-line" id="crayon-5aa2982a5bd3f912459819-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">items</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>项目中的<span class="crayon-i">item</span>文件</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd3f912459819-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pipelines</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp; </span>项目中的<span class="crayon-i">pipelines</span>文件<span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5aa2982a5bd3f912459819-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-v">py</span><span class="crayon-o">:</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span>项目全局设置文件<span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd3f912459819-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">spiders</span><span class="crayon-o">/</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>爬虫模块目录</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
<p>我们先看一下scrapy的处理流程<br />
<img src="http://jbcdn2.b0.upaiyun.com/2016/10/c24dade2ab6bc0143a2abc9d271136d0.png" /></p>
<p>scrapy由下面几个部分组成</p>
<ul>
<li><code>spiders</code>：爬虫模块，负责配置需要爬取的数据和爬取规则，以及解析结构化数据</li>
<li><code>items</code>：定义我们需要的结构化数据，使用相当于<code>dict</code></li>
<li><code>pipelines</code>：管道模块，处理spider模块分析好的结构化数据，如保存入库等</li>
<li><code>middlewares</code>：中间件，相当于钩子，可以对爬取前后做预处理，如修改请求header，url过滤等</li>
</ul>
<p>我们先来看一个例子，在<code>spiders</code>目录下新建一个模块<code>DmozSpider.py</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd43897726805" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
import scrapy

class DmozSpider(scrapy.Spider):
    # 必须定义
    name = "dmoz"
    # 初始urls
    start_urls = [
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Books/",
        "http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/"
    ]

    # 默认response处理函数
    def parse(self, response):
        # 把结果写到文件中
        filename = response.url.split("/")[-2]
        with open(filename, 'wb') as f:
            f.write(response.body)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd43897726805-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd43897726805-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-1"><span class="crayon-e">import </span><span class="crayon-e">scrapy</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DmozSpider</span><span class="crayon-sy">(</span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">Spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 必须定义</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"dmoz"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 初始urls</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">start_urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"http://www.dmoz.org/Computers/Programming/Languages/Python/Books/"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 默认response处理函数</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 把结果写到文件中</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">filename</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"/"</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd43897726805-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">with </span><span class="crayon-e">open</span><span class="crayon-sy">(</span><span class="crayon-v">filename</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'wb'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd43897726805-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">body</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>打开终端进入根目录，执行下面命令</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd46088730787" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
$ scrapy crawl dmoz</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd46088730787-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd46088730787-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">scrapy </span><span class="crayon-e">crawl </span><span class="crayon-v">dmoz</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>爬虫开始爬取start_urls定义的url，并输出到文件中，最后输出爬去报告，会输出爬取得统计结果</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd4a261516276" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
2016-09-13 10:36:43 [scrapy] INFO: Spider opened
2016-09-13 10:36:43 [scrapy] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2016-09-13 10:36:43 [scrapy] DEBUG: Telnet console listening on 127.0.0.1:6023
2016-09-13 10:36:44 [scrapy] DEBUG: Crawled (200) &lt;GET http://www.dmoz.org/Computers/Programming/Languages/Python/Resources/&gt; (referer: None)
2016-09-13 10:36:45 [scrapy] DEBUG: Crawled (200) &lt;GET http://www.dmoz.org/Computers/Programming/Languages/Python/Books/&gt; (referer: None)
2016-09-13 10:36:45 [scrapy] INFO: Closing spider (finished)
2016-09-13 10:36:45 [scrapy] INFO: Dumping Scrapy stats:
{'downloader/request_bytes': 548,
 'downloader/request_count': 2,
 'downloader/request_method_count/GET': 2,
 'downloader/response_bytes': 16179,
 'downloader/response_count': 2,
 'downloader/response_status_count/200': 2,
 'finish_reason': 'finished',
 'finish_time': datetime.datetime(2016, 9, 13, 2, 36, 45, 585113),
 'log_count/DEBUG': 3,
 'log_count/INFO': 7,
 'response_received_count': 2,
 'scheduler/dequeued': 2,
 'scheduler/dequeued/memory': 2,
 'scheduler/enqueued': 2,
 'scheduler/enqueued/memory': 2,
 'start_time': datetime.datetime(2016, 9, 13, 2, 36, 43, 935790)}
2016-09-13 10:36:45 [scrapy] INFO: Spider closed (finished)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-18">18</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-20">20</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-22">22</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4a261516276-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4a261516276-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-1"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">INFO</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Spider </span><span class="crayon-i">opened</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-2"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">INFO</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-i">Crawled</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-e">pages</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-v">pages</span><span class="crayon-o">/</span><span class="crayon-k ">min</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">scraped</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-e">items</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-i">at</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-v">items</span><span class="crayon-o">/</span><span class="crayon-k ">min</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-3"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">43</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">DEBUG</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Telnet </span><span class="crayon-e">console </span><span class="crayon-e">listening </span><span class="crayon-i">on</span><span class="crayon-h"> </span><span class="crayon-cn">127.0.0.1</span><span class="crayon-o">:</span><span class="crayon-cn">6023</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-4"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">44</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">DEBUG</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Crawled</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">GET </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">www</span><span class="crayon-sy">.</span><span class="crayon-v">dmoz</span><span class="crayon-sy">.</span><span class="crayon-v">org</span><span class="crayon-o">/</span><span class="crayon-v">Computers</span><span class="crayon-o">/</span><span class="crayon-v">Programming</span><span class="crayon-o">/</span><span class="crayon-v">Languages</span><span class="crayon-o">/</span><span class="crayon-v">Python</span><span class="crayon-o">/</span><span class="crayon-v">Resources</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">referer</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-5"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">DEBUG</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Crawled</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">200</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-e">GET </span><span class="crayon-v">http</span><span class="crayon-o">:</span><span class="crayon-o">/</span><span class="crayon-o">/</span><span class="crayon-v">www</span><span class="crayon-sy">.</span><span class="crayon-v">dmoz</span><span class="crayon-sy">.</span><span class="crayon-v">org</span><span class="crayon-o">/</span><span class="crayon-v">Computers</span><span class="crayon-o">/</span><span class="crayon-v">Programming</span><span class="crayon-o">/</span><span class="crayon-v">Languages</span><span class="crayon-o">/</span><span class="crayon-v">Python</span><span class="crayon-o">/</span><span class="crayon-v">Books</span><span class="crayon-o">/</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">referer</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-6"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">INFO</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Closing </span><span class="crayon-e">spider</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">finished</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-7"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">INFO</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Dumping </span><span class="crayon-e">Scrapy </span><span class="crayon-v">stats</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-8"><span class="crayon-sy">{</span><span class="crayon-s">'downloader/request_bytes'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">548</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-9"><span class="crayon-h"> </span><span class="crayon-s">'downloader/request_count'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-10"><span class="crayon-h"> </span><span class="crayon-s">'downloader/request_method_count/GET'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-11"><span class="crayon-h"> </span><span class="crayon-s">'downloader/response_bytes'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">16179</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-12"><span class="crayon-h"> </span><span class="crayon-s">'downloader/response_count'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-13"><span class="crayon-h"> </span><span class="crayon-s">'downloader/response_status_count/200'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-14"><span class="crayon-h"> </span><span class="crayon-s">'finish_reason'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'finished'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-15"><span class="crayon-h"> </span><span class="crayon-s">'finish_time'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-k ">datetime</span><span class="crayon-sy">(</span><span class="crayon-cn">2016</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">585113</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-16"><span class="crayon-h"> </span><span class="crayon-s">'log_count/DEBUG'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-17"><span class="crayon-h"> </span><span class="crayon-s">'log_count/INFO'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-18"><span class="crayon-h"> </span><span class="crayon-s">'response_received_count'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-19"><span class="crayon-h"> </span><span class="crayon-s">'scheduler/dequeued'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-20"><span class="crayon-h"> </span><span class="crayon-s">'scheduler/dequeued/memory'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-21"><span class="crayon-h"> </span><span class="crayon-s">'scheduler/enqueued'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-22"><span class="crayon-h"> </span><span class="crayon-s">'scheduler/enqueued/memory'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4a261516276-23"><span class="crayon-h"> </span><span class="crayon-s">'start_time'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-sy">.</span><span class="crayon-k ">datetime</span><span class="crayon-sy">(</span><span class="crayon-cn">2016</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">43</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">935790</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4a261516276-24"><span class="crayon-cn">2016</span><span class="crayon-o">-</span><span class="crayon-cn">09</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-cn">36</span><span class="crayon-o">:</span><span class="crayon-cn">45</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">scrapy</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">INFO</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Spider </span><span class="crayon-e">closed</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">finished</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0101 seconds] -->
<p>这里我们完成了简单的爬取和保存的操作，会在根目录生成两个文件<code>Resources</code>和<code>Books</code></p>
<h3>2. 通过代码运行爬虫</h3>
<p>每次进入控制台运行爬虫还是比较麻烦的，而且不好调试，我们可以通过<code>CrawlerProcess</code>通过代码运行爬虫，新建一个模块<code>run.py</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd4e931059598" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy.crawler import CrawlerProcess
from scrapy.utils.project import get_project_settings

from spiders.DmozSpider import DmozSpider

# 获取settings.py模块的设置
settings = get_project_settings()
process = CrawlerProcess(settings=settings)

# 可以添加多个spider
# process.crawl(Spider1)
# process.crawl(Spider2)
process.crawl(DmozSpider)

# 启动爬虫，会阻塞，直到爬取完成
process.start()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd4e931059598-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd4e931059598-16">16</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-1"><span class="crayon-e">from </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">crawler </span><span class="crayon-e">import </span><span class="crayon-e">CrawlerProcess</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-2"><span class="crayon-e">from </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">project </span><span class="crayon-e">import </span><span class="crayon-e">get_project_settings</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-4"><span class="crayon-e">from </span><span class="crayon-v">spiders</span><span class="crayon-sy">.</span><span class="crayon-e">DmozSpider </span><span class="crayon-e">import </span><span class="crayon-v">DmozSpider</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-6"><span class="crayon-p"># 获取settings.py模块的设置</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-7"><span class="crayon-v">settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_project_settings</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-8"><span class="crayon-v">process</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CrawlerProcess</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-o">=</span><span class="crayon-v">settings</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-10"><span class="crayon-p"># 可以添加多个spider</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-11"><span class="crayon-p"># process.crawl(Spider1)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-12"><span class="crayon-p"># process.crawl(Spider2)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-13"><span class="crayon-v">process</span><span class="crayon-sy">.</span><span class="crayon-e">crawl</span><span class="crayon-sy">(</span><span class="crayon-v">DmozSpider</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-14">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd4e931059598-15"><span class="crayon-p"># 启动爬虫，会阻塞，直到爬取完成</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd4e931059598-16"><span class="crayon-v">process</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p></p>
<blockquote><p>参考：<a href="http://doc.scrapy.org/en/latest/topics/practices.html#run-scrapy-from-a-script">http://doc.scrapy.org/en/latest/topics/practices.html#run-scrapy-from-a-script</a></p></blockquote>
<h2>三、Scrapy类</h2>
<p>如上面的<code>DmozSpider</code>类，爬虫类继承自<code>scrapy.Spider</code>，用于构造<code>Request</code>对象给Scheduler</p>
<h3>1. 常用属性与方法</h3>
<p><em>属性</em></p>
<ul>
<li><code>name</code>：爬虫的名字，必须唯一（如果在控制台使用的话，必须配置）</li>
<li><code>start_urls</code>：爬虫初始爬取的链接列表</li>
<li><code>parse</code>：response结果处理函数</li>
<li><code>custom_settings</code>：自定义配置，覆盖<code>settings.py</code>中的默认配置</li>
</ul>
<p><em>方法</em></p>
<ul>
<li><code>start_requests</code>：启动爬虫的时候调用，默认是调用<code>make_requests_from_url</code>方法爬取<code>start_urls</code>的链接，可以在这个方法里面定制，如果重写了该方法，start_urls默认将不会被使用，可以在这个方法里面定制一些自定义的url，如登录，从数据库读取url等，本方法返回Request对象</li>
<li><code>make_requests_from_url</code>：默认由<code>start_requests</code>调用，可以配置Request对象，返回Request对象</li>
<li><code>parse</code>：response到达spider的时候默认调用，如果在Request对象配置了callback函数，则不会调用，parse方法可以迭代返回<code>Item</code>或<code>Request</code>对象，如果返回Request对象，则会进行增量爬取</li>
</ul>
<h3>2. Request与Response对象</h3>
<p>每个请求都是一个Request对象，Request对象定义了请求的相关信息（<code>url</code>, <code>method</code>, <code>headers</code>, <code>body</code>, <code>cookie</code>, <code>priority</code>）和回调的相关信息（<code>meta</code>, <code>callback</code>, <code>dont_filter</code>, <code>errback</code>），通常由spider迭代返回</p>
<p>其中<code>meta</code>相当于附加变量，可以在请求完成后通过<code>response.meta</code>访问</p>
<p>请求完成后，会通过<code>Response</code>对象发送给spider处理，常用属性有（<code>url</code>, <code>status</code>, <code>headers</code>, <code>body</code>, <code>request</code>, <code>meta</code>, ）</p>
<p>详细介绍参考官网</p>
<ul>
<li><a href="https://doc.scrapy.org/en/latest/topics/request-response.html#request-objects">https://doc.scrapy.org/en/latest/topics/request-response.html#request-objects</a></li>
<li><a href="https://doc.scrapy.org/en/latest/topics/request-response.html#response-objects">https://doc.scrapy.org/en/latest/topics/request-response.html#response-objects</a></li>
</ul>
<p>看下面这个例子</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd53635496483" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy import Spider
from scrapy import Request

class TestSpider(Spider):
    name = 'test'
    start_urls = [
        "http://www.qq.com/",
    ]

    def login_parse(self, response):
        ''' 如果登录成功,手动构造请求Request迭代返回 '''
        print response
        for i in range(0, 10):
            yield Request('http://www.example.com/list/1?page={0}'.format(i))

    def start_requests(self):
        ''' 覆盖默认的方法(忽略start_urls),返回登录请求页,制定处理函数为login_parse '''
        return Request('http://www.example.com/login', method="POST" body='username=bomo&amp;pwd=123456', callback=self.login_parse)


    def parse(self, response):
        ''' 默认请求处理函数 '''
        print response</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-18">18</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-20">20</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd53635496483-22">22</div><div class="crayon-num" data-line="crayon-5aa2982a5bd53635496483-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-1"><span class="crayon-e">from </span><span class="crayon-e">scrapy </span><span class="crayon-e">import </span><span class="crayon-e">Spider</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-2"><span class="crayon-e">from </span><span class="crayon-e">scrapy </span><span class="crayon-e">import </span><span class="crayon-e">Request</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TestSpider</span><span class="crayon-sy">(</span><span class="crayon-v">Spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'test'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">start_urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"http://www.qq.com/"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">login_parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">''</span><span class="crayon-s">' 如果登录成功,手动构造请求Request迭代返回 '</span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-e">response</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-13"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">yield </span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-s">'http://www.example.com/list/1?page={0}'</span><span class="crayon-sy">.</span><span class="crayon-e">format</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">start_requests</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">''</span><span class="crayon-s">' 覆盖默认的方法(忽略start_urls),返回登录请求页,制定处理函数为login_parse '</span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-s">'http://www.example.com/login'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">method</span><span class="crayon-o">=</span><span class="crayon-s">"POST"</span><span class="crayon-h"> </span><span class="crayon-v">body</span><span class="crayon-o">=</span><span class="crayon-s">'username=bomo&amp;pwd=123456'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-o">=</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">login_parse</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-20">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd53635496483-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">''</span><span class="crayon-s">' 默认请求处理函数 '</span><span class="crayon-s">''</span></div><div class="crayon-line" id="crayon-5aa2982a5bd53635496483-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-v">response</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<h2>四、Selector</h2>
<p>上面我们只是爬取了网页的html文本，对于爬虫，我们需要明确我们需要爬取的结构化数据，需要对原文本进行解析，解析的方法通常有下面这些</p>
<ul>
<li>普通文本操作</li>
<li>正则表达式：<code>re</code></li>
<li>Dom树操作：<code>BeautifulSoup</code></li>
<li>XPath选择器：<code>lxml</code></li>
</ul>
<p>scrapy默认支持选择器的功能，自带的选择器构建与lxml之上，并对其进行了改进，使用起来更为简洁明了</p>
<h3>1. XPath选择器</h3>
<p>XPpath是标准的XML文档查询语言，可以用于查询XML文档中的节点和内容，关于XPath语法，可以参见<a href="http://www.w3school.com.cn/xpath/">这里</a></p>
<p>先看一个例子，通过html或xml构造Selector对象，然后通过xpath查询节点，并解析出节点的内容</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd58737527396" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy import Selector

html = '&lt;html&gt;&lt;body&gt;&lt;span&gt;good&lt;/span&gt;&lt;span&gt;buy&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;'
sel = Selector(text=html)
nodes = sel.xpath('//span')
for node in nodes:
    print node.extract()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd58737527396-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd58737527396-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd58737527396-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd58737527396-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd58737527396-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd58737527396-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd58737527396-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd58737527396-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">scrapy </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Selector</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd58737527396-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd58737527396-3"><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'&lt;html&gt;&lt;body&gt;&lt;span&gt;good&lt;/span&gt;&lt;span&gt;buy&lt;/span&gt;&lt;/body&gt;&lt;/html&gt;'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd58737527396-4"><span class="crayon-v">sel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Selector</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-o">=</span><span class="crayon-v">html</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd58737527396-5"><span class="crayon-v">nodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sel</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">'//span'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd58737527396-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">node </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">nodes</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd58737527396-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">node</span><span class="crayon-sy">.</span><span class="crayon-e">extract</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>Selector相当于节点，通过xpath去到子节点集合（SelectorList），可以继续搜索，通过<code>extract</code>方法可以取出节点的值，<code>extract</code>方法也可以作用于SelectorList，对于SelectorList可以通过<code>extract_first</code>取出第一个节点的值</p>
<ul>
<li>通过<code>text()</code>取出节点的内容</li>
<li>通过<code>@href</code>去除节点属性值（这里是取出<code>href</code>属性的值）</li>
<li>直接对节点取值，则是输出节点的字符串</li>
</ul>
<h3>2. CSS选择器</h3>
<p>除了XPath选择器，scrapy还支持css选择器</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd5b242940209" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
html = """
        &lt;html&gt;
            &lt;body&gt;
                &lt;span&gt;good&lt;/span&gt;
                &lt;span&gt;buy&lt;/span&gt;
                &lt;ul&gt;
                    &lt;li class="video_part_lists"&gt;aa&lt;li&gt;
                    &lt;li class="video_part_lists"&gt;bb&lt;li&gt;
                    &lt;li class="audio_part_lists"&gt;cc&lt;li&gt;
                    &lt;li class="video_part_lists"&gt;
                        &lt;a href="/"&gt;主页&lt;/a&gt;
                    &lt;li&gt;
                &lt;/ul&gt;
            &lt;/body&gt;
        &lt;/html&gt;
        """
sel = Selector(text=html)

# 选择class为video_part_lists的li节点
lis = sel.css('li.video_part_lists')

for li in lis:
    # 选择a节点的属性
    print li.css('a::attr(href)').extract()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-18">18</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-20">20</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-22">22</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5b242940209-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5b242940209-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-1"><span class="crayon-v">html</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"""</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-2"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;html&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-3"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-4"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;good&lt;/span&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-5"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;span&gt;buy&lt;/span&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-6"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;ul&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-7"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="video_part_lists"&gt;aa&lt;li&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-8"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="video_part_lists"&gt;bb&lt;li&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-9"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="audio_part_lists"&gt;cc&lt;li&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-10"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li class="video_part_lists"&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-11"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/"&gt;主页&lt;/a&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-12"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;li&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-13"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/ul&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-14"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-15"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/html&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-16"><span class="crayon-s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-17"><span class="crayon-v">sel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Selector</span><span class="crayon-sy">(</span><span class="crayon-v">text</span><span class="crayon-o">=</span><span class="crayon-v">html</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-18">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-19"><span class="crayon-c"># 选择class为video_part_lists的li节点</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-20"><span class="crayon-v">lis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sel</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">'li.video_part_lists'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-22"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">li </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lis</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5b242940209-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># 选择a节点的属性</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5b242940209-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-h"> </span><span class="crayon-v">li</span><span class="crayon-sy">.</span><span class="crayon-e">css</span><span class="crayon-sy">(</span><span class="crayon-s">'a::attr(href)'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p>关于css选择器更多的规则，可以见w3c官网</p>
<ul>
<li><a href="https://www.w3.org/TR/selectors/">https://www.w3.org/TR/selectors/</a></li>
</ul>
<h2>五、Item类</h2>
<p>上面我们只是爬取了网页的html文本，对于爬虫，我们需要明确我们需要爬取的结构化数据，我们定义一个item存储分类信息，scrapy的item继承自<code>scrapy.Item</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd5f264278798" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy import Item, Field

class DmozItem(Item):
    title = Field()
    link = Field()
    desc = Field()</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd5f264278798-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5f264278798-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5f264278798-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5f264278798-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd5f264278798-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd5f264278798-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd5f264278798-1"><span class="crayon-e">from </span><span class="crayon-e">scrapy </span><span class="crayon-e">import </span><span class="crayon-v">Item</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Field</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5f264278798-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd5f264278798-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DmozItem</span><span class="crayon-sy">(</span><span class="crayon-v">Item</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5f264278798-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd5f264278798-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">link</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd5f264278798-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">desc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Field</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p><code>scrapy.Item</code>的用法与python中的字典用法基本一样，只是做了一些安全限制，属性定义使用Field，这里只是进行了声明，而不是真正的属性，使用的时候通过键值对操作，<strong>不支持属性访问</strong></p>
<p>what, 好坑爹，这意味着所有的属性赋值都得用字符串了，这里有解释（还是没太明白）</p>
<blockquote>
<ul>
<li><a href="http://stackoverflow.com/questions/14899815/why-is-scrapys-field-a-dict">why-is-scrapys-field-a-dict</a></li>
</ul>
</blockquote>
<p>修改DmozSpider的parse方法</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd63345082625" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
class DmozSpider(scrapy.Spider):
    ...
    def parse(self, response):
        for sel in response.xpath('//ul/li'):
            dmoz_item = DmozItem()
            dmoz_item['title'] = sel.xpath('a/text()').extract()
            dmoz_item['link'] = sel.xpath('a/@href').extract()
            dmoz_item['desc'] = sel.xpath('text()').extract()
            print dmoz_item</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd63345082625-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd63345082625-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd63345082625-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd63345082625-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd63345082625-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd63345082625-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd63345082625-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd63345082625-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd63345082625-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd63345082625-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DmozSpider</span><span class="crayon-sy">(</span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">Spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd63345082625-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5aa2982a5bd63345082625-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd63345082625-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">sel </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">'//ul/li'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd63345082625-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dmoz_item</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DmozItem</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd63345082625-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dmoz_item</span><span class="crayon-sy">[</span><span class="crayon-s">'title'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sel</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">'a/text()'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd63345082625-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dmoz_item</span><span class="crayon-sy">[</span><span class="crayon-s">'link'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sel</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">'a/@href'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd63345082625-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">dmoz_item</span><span class="crayon-sy">[</span><span class="crayon-s">'desc'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sel</span><span class="crayon-sy">.</span><span class="crayon-e">xpath</span><span class="crayon-sy">(</span><span class="crayon-s">'text()'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">extract</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd63345082625-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-v">dmoz_item</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p></p>
<h2>六、Pipeline</h2>
<p>spider负责爬虫的配置，item负责声明结构化数据，而对于数据的处理，在scrapy中使用管道的方式进行处理，只要注册过的管道都可以处理item数据（处理，过滤，保存）</p>
<p>下面看看管道的声明方式，这里定义一个预处理管道<code>PretreatmentPipeline.py</code>，如果item的title为None，则设置为空字符串</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd66456226440" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
class PretreatmentPipeline(object):
    def process_item(self, item, spider):
        if item['title']:
            # 不让title为空
            item['title'] = ''
        return item</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd66456226440-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd66456226440-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd66456226440-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd66456226440-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd66456226440-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd66456226440-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd66456226440-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PretreatmentPipeline</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd66456226440-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">process_item</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd66456226440-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">[</span><span class="crayon-s">'title'</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd66456226440-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 不让title为空</span></div><div class="crayon-line" id="crayon-5aa2982a5bd66456226440-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">item</span><span class="crayon-sy">[</span><span class="crayon-s">'title'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd66456226440-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">item</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>再定义一个过滤重复数据的管道<code>DuplicatesPipeline.py</code>，当link重复，则丢弃</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd6a793112253" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy.exceptions import DropItem

class DuplicatesPipeline(object):
    def __init__(self):
        self.links = set()

    def process_item(self, item, spider):
        if item['link'] in self.links:
            # 跑出DropItem表示丢掉数据
            raise DropItem("Duplicate item found: %s" % item)
        else:
            self.links.add(item['link'])
            return item</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6a793112253-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6a793112253-13">13</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-1"><span class="crayon-e">from </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">exceptions </span><span class="crayon-e">import </span><span class="crayon-e">DropItem</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DuplicatesPipeline</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">links</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-6">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">process_item</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">[</span><span class="crayon-s">'link'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">links</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 跑出DropItem表示丢掉数据</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">raise </span><span class="crayon-e">DropItem</span><span class="crayon-sy">(</span><span class="crayon-s">"Duplicate item found: %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6a793112253-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">links</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">item</span><span class="crayon-sy">[</span><span class="crayon-s">'link'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6a793112253-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">item</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>最后可以定义一个保存数据的管道，可以把数据保存到数据库中</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd6e614571783" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy.exceptions import DropItem
from Database import Database

class DatabasePipeline(object):
    def __init__(self):
        self.db = Database

    def process_item(self, item, spider):
        if self.db.item_exists(item['id']):
            self.db.update_item(item)
        else:
            self.db.insert_item(item)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd6e614571783-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd6e614571783-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-1"><span class="crayon-e">from </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">exceptions </span><span class="crayon-e">import </span><span class="crayon-e">DropItem</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-2"><span class="crayon-e">from </span><span class="crayon-e">Database </span><span class="crayon-e">import </span><span class="crayon-e">Database</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">DatabasePipeline</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Database</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-8"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">process_item</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">item</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">item_exists</span><span class="crayon-sy">(</span><span class="crayon-v">item</span><span class="crayon-sy">[</span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">update_item</span><span class="crayon-sy">(</span><span class="crayon-v">item</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd6e614571783-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd6e614571783-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-e">insert_item</span><span class="crayon-sy">(</span><span class="crayon-v">item</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>定义好管道之后我们需要配置到爬虫上，我们在<code>settings.py</code>模块中配置，后面的数字表示管道的顺序</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd71132416571" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
ITEM_PIPELINES = {
    'pipelines.DuplicatesPipeline.DuplicatesPipeline': 1,
    'pipelines.PretreatmentPipeline.PretreatmentPipeline': 2,
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd71132416571-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd71132416571-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd71132416571-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd71132416571-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd71132416571-1"><span class="crayon-v">ITEM_PIPELINES</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd71132416571-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'pipelines.DuplicatesPipeline.DuplicatesPipeline'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd71132416571-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'pipelines.PretreatmentPipeline.PretreatmentPipeline'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd71132416571-4"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p>我们也可以为spider配置单独的pipeline</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd74977779744" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
class TestSpider(Spider):
    # 自定义配置
    custom_settings = {
        # item处理管道
        'ITEM_PIPELINES': {
            'tutorial.pipelines.FangDetailPipeline.FangDetailPipeline': 1,
        },
    }
    ...</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd74977779744-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd74977779744-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd74977779744-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd74977779744-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd74977779744-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd74977779744-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd74977779744-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd74977779744-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd74977779744-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd74977779744-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">TestSpider</span><span class="crayon-sy">(</span><span class="crayon-v">Spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd74977779744-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 自定义配置</span></div><div class="crayon-line" id="crayon-5aa2982a5bd74977779744-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">custom_settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd74977779744-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># item处理管道</span></div><div class="crayon-line" id="crayon-5aa2982a5bd74977779744-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'ITEM_PIPELINES'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd74977779744-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'tutorial.pipelines.FangDetailPipeline.FangDetailPipeline'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd74977779744-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd74977779744-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5aa2982a5bd74977779744-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p>除了<code>process_item</code>方法外，pipeline还有<code>open_spider</code>和<code>spider_closed</code>两个方法，在爬虫启动和关闭的时候调用</p>
<h2>七、Rule</h2>
<p>爬虫的通常需要在一个网页里面爬去其他的链接，然后一层一层往下爬，scrapy提供了LinkExtractor类用于对网页链接的提取，使用LinkExtractor需要使用<code>CrawlSpider</code>爬虫类中，<code>CrawlSpider</code>与<code>Spider</code>相比主要是多了<code>rules</code>，可以添加一些规则，先看下面这个例子，爬取链家网的链接</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd78117712345" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy.spiders import CrawlSpider, Rule
from scrapy.linkextractors import LinkExtractor

class LianjiaSpider(CrawlSpider):
    name = "lianjia"

    allowed_domains = ["lianjia.com"]

    start_urls = [
        "http://bj.lianjia.com/ershoufang/"
    ]

    rules = [
        # 匹配正则表达式,处理下一页
        Rule(LinkExtractor(allow=(r'http://bj.lianjia.com/ershoufang/pg\s+$',)), callback='parse_item'),

        # 匹配正则表达式,结果加到url列表中,设置请求预处理函数
        # Rule(FangLinkExtractor(allow=('http://www.lianjia.com/client/', )), follow=True, process_request='add_cookie')
    ]

    def parse_item(self, response):
        # 这里与之前的parse方法一样，处理
        pass</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-18">18</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-20">20</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd78117712345-22">22</div><div class="crayon-num" data-line="crayon-5aa2982a5bd78117712345-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">spiders </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">CrawlSpider</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">Rule</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">linkextractors </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LinkExtractor</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-4"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">LianjiaSpider</span><span class="crayon-sy">(</span><span class="crayon-v">CrawlSpider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"lianjia"</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-6">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">allowed_domains</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"lianjia.com"</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-8">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">start_urls</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"http://bj.lianjia.com/ershoufang/"</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-12">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rules</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># 匹配正则表达式,处理下一页</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">Rule</span><span class="crayon-sy">(</span><span class="crayon-e">LinkExtractor</span><span class="crayon-sy">(</span><span class="crayon-v">allow</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-i">r</span><span class="crayon-s">'http://bj.lianjia.com/ershoufang/pg\s+$'</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callback</span><span class="crayon-o">=</span><span class="crayon-s">'parse_item'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-16">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># 匹配正则表达式,结果加到url列表中,设置请求预处理函数</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># Rule(FangLinkExtractor(allow=('http://www.lianjia.com/client/', )), follow=True, process_request='add_cookie')</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-20">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">parse_item</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd78117712345-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># 这里与之前的parse方法一样，处理</span></div><div class="crayon-line" id="crayon-5aa2982a5bd78117712345-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">pass</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p></p>
<h3>1. Rule对象</h3>
<p>Role对象有下面参数</p>
<ul>
<li><code>link_extractor</code>：链接提取规则</li>
<li><code>callback</code>：link_extractor提取的链接的请求结果的回调</li>
<li><code>cb_kwargs</code>：附加参数，可以在回调函数中获取到</li>
<li><code>follow</code>：表示提取的链接请求完成后是否还要应用当前规则（boolean），如果为<code>False</code>则不会对提取出来的网页进行进一步提取，默认为False</li>
<li><code>process_links</code>：处理所有的链接的回调，用于处理从response提取的links，通常用于过滤（参数为link列表）</li>
<li><code>process_request</code>：链接请求预处理（添加header或cookie等）</li>
</ul>
<h3>2. LinkExtractor</h3>
<p>LinkExtractor常用的参数有：</p>
<ul>
<li><code>allow</code>：提取满足正则表达式的链接</li>
<li><code>deny</code>：排除正则表达式匹配的链接（优先级高于<code>allow</code>）</li>
<li><code>allow_domains</code>：允许的域名（可以是<code>str</code>或<code>list</code>）</li>
<li><code>deny_domains</code>：排除的域名（可以是<code>str</code>或<code>list</code>）</li>
<li><code>restrict_xpaths</code>：提取满足XPath选择条件的链接（可以是<code>str</code>或<code>list</code>）</li>
<li><code>restrict_css</code>：提取满足css选择条件的链接（可以是<code>str</code>或<code>list</code>）</li>
<li><code>tags</code>：提取指定标签下的链接，默认从<code>a</code>和<code>area</code>中提取（可以是<code>str</code>或<code>list</code>）</li>
<li><code>attrs</code>：提取满足拥有属性的链接，默认为<code>href</code>（类型为<code>list</code>）</li>
<li><code>unique</code>：链接是否去重（类型为<code>boolean</code>）</li>
<li><code>process_value</code>：值处理函数（优先级大于<code>allow</code>）</li>
</ul>
<p>关于LinkExtractor的详细参数介绍见<a href="http://doc.scrapy.org/en/latest/topics/link-extractors.html#module-scrapy.linkextractors.lxmlhtml">官网</a></p>
<blockquote><p>注意：如果使用rules规则，请不要覆盖或重写<code>CrawlSpider</code>的<code>parse</code>方法，否则规则会失效，可以使用<code>parse_start_urls</code>方法</p></blockquote>
<h2>八、Middleware</h2>
<p>从最开始的流程图可以看到，爬去一个资源链接的流程，首先我们配置spider相关的爬取信息，在启动爬取实例后，<code>scrapy_engine</code>从Spider取出<code>Request</code>（经过<code>SpiderMiddleware</code>），然后丢给Scheduler（经过<code>SchedulerMiddleware</code>），Scheduler接着把请求丢给Downloader（经过<code>DownloadMiddlware</code>），Downloader把请求结果丢还给Spider，然后Spider把分析好的结构化数据丢给Pipeline，Pipeline进行分析保存或丢弃，这里面有4个角色</p>
<p>scrapy有下面三种middlewares</p>
<ul>
<li><code>SpiderMiddleware</code>：通常用于配置爬虫相关的属性，引用链接设置，Url长度限制，成功状态码设置，爬取深度设置，爬去优先级设置等</li>
<li><code>DownloadMiddlware</code>：通常用于处理下载之前的预处理，如请求Header（Cookie,User-Agent），登录验证处理，重定向处理，代理服务器处理，超时处理，重试处理等</li>
<li><code>SchedulerMiddleware</code>（已经废弃）：为了简化框架，调度器中间件已经被废弃，使用另外两个中间件已经够用了</li>
</ul>
<h3>1. SpiderMiddleware</h3>
<p>爬虫中间件有下面几个方法</p>
<ul>
<li><code>process_spider_input</code>：当response通过spider的时候被调用，返回None（继续给其他中间件处理）或抛出异常（不会给其他中间件处理，当成异常处理）</li>
<li><code>process_spider_output</code>：当spider有item或Request输出的时候调动</li>
<li><code>process_spider_exception</code>：处理出现异常时调用</li>
<li><code>process_start_requests</code>：spider当开始请求Request的时候调用</li>
</ul>
<p>下面是scrapy自带的一些中间件（在<code>scrapy.spidermiddlewares</code>命名空间下）</p>
<ul>
<li>UrlLengthMiddleware</li>
<li>RefererMiddleware</li>
<li>OffsiteMiddleware</li>
<li>HttpErrorMiddleware</li>
<li>DepthMiddleware</li>
</ul>
<p>我们自己实现一个<code>SpiderMiddleware</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd7e057644469" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
TODO</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd7e057644469-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd7e057644469-1"><span class="crayon-v">TODO</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p></p>
<blockquote><p>参考链接：<a href="http://doc.scrapy.org/en/latest/topics/spider-middleware.html">http://doc.scrapy.org/en/latest/topics/spider-middleware.html</a></p></blockquote>
<h3>2. DownloaderMiddleware</h3>
<p>下载中间件有下面几个方法</p>
<ul>
<li><code>process_request</code>：请求通过下载器的时候调用</li>
<li><code>process_response</code>：请求完成后调用</li>
<li><code>process_exception</code>：请求发生异常时调用</li>
<li><code>from_crawler</code>：从crawler构造的时候调用</li>
<li><code>from_settings</code>：从settings构造的时候调用</li>
<li><code></code></li>
</ul>
<blockquote><p>更多详细的参数解释见<a href="https://scrapy-chs.readthedocs.io/zh_CN/0.24/topics/downloader-middleware.html#id2">这里</a></p></blockquote>
<p>在爬取网页的时候，使用不同的<code>User-Agent</code>可以提高请求的随机性，定义一个随机设置User-Agent的中间件<code>RandomUserAgentMiddleware</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd82390597056" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
import random

class RandomUserAgentMiddleware(object):
    """Randomly rotate user agents based on a list of predefined ones"""

    def __init__(self, agents):
        self.agents = agents

    # 从crawler构造，USER_AGENTS定义在crawler的配置的设置中
    @classmethod
    def from_crawler(cls, crawler):
        return cls(crawler.settings.getlist('USER_AGENTS'))

    # 从settings构造，USER_AGENTS定义在settings.py中
    @classmethod
    def from_settings(cls, settings):
        return cls(settings.getlist('USER_AGENTS'))

    def process_request(self, request, spider):
        # 设置随机的User-Agent
        request.headers.setdefault('User-Agent', random.choice(self.agents))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-18">18</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd82390597056-20">20</div><div class="crayon-num" data-line="crayon-5aa2982a5bd82390597056-21">21</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-1"><span class="crayon-e">import </span><span class="crayon-e">random</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">RandomUserAgentMiddleware</span><span class="crayon-sy">(</span><span class="crayon-t">object</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">""</span><span class="crayon-s">"Randomly rotate user agents based on a list of predefined ones"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">agents</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">agents</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">agents</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-8">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 从crawler构造，USER_AGENTS定义在crawler的配置的设置中</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">@</span><span class="crayon-e">classmethod</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-11"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">from_crawler</span><span class="crayon-sy">(</span><span class="crayon-v">cls</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crawler</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">cls</span><span class="crayon-sy">(</span><span class="crayon-v">crawler</span><span class="crayon-sy">.</span><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-e">getlist</span><span class="crayon-sy">(</span><span class="crayon-s">'USER_AGENTS'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 从settings构造，USER_AGENTS定义在settings.py中</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">@</span><span class="crayon-e">classmethod</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-16"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">from_settings</span><span class="crayon-sy">(</span><span class="crayon-v">cls</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">settings</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">cls</span><span class="crayon-sy">(</span><span class="crayon-v">settings</span><span class="crayon-sy">.</span><span class="crayon-e">getlist</span><span class="crayon-sy">(</span><span class="crayon-s">'USER_AGENTS'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-18">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">process_request</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd82390597056-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 设置随机的User-Agent</span></div><div class="crayon-line" id="crayon-5aa2982a5bd82390597056-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">.</span><span class="crayon-e">setdefault</span><span class="crayon-sy">(</span><span class="crayon-s">'User-Agent'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">agents</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
<p>在<code>settings.py</code>设置USER_AGENTS参数</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd86125302144" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
USER_AGENTS = [
    "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)",
    "Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)",
    "Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)",
    "Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)",
    "Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)",
    "Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)",
    "Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)",
    "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)",
    "Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6",
    "Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1",
    "Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0",
    "Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5",
    "Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6",
    "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11",
    "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20",
    "Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52",
]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bd86125302144-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd86125302144-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-1"><span class="crayon-v">USER_AGENTS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd86125302144-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd86125302144-18"><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>配置爬虫中间件的方式与pipeline类似，第二个参数表示优先级</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd8a407022116" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
# 配置爬虫中间件
SPIDER_MIDDLEWARES = {
    'myproject.middlewares.CustomSpiderMiddleware': 543,
    # 如果想禁用默认的中间件的话，可以设置其优先级为None
    'scrapy.spidermiddlewares.offsite.OffsiteMiddleware': None,
}

# 配置下载中间件
DOWNLOADER_MIDDLEWARES = {
    'myproject.middlewares.RandomUserAgentMiddleware': 543,
    'scrapy.contrib.downloadermiddleware.useragent.UserAgentMiddleware': None,
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8a407022116-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8a407022116-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-1"><span class="crayon-p"># 配置爬虫中间件</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-2"><span class="crayon-v">SPIDER_MIDDLEWARES</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'myproject.middlewares.CustomSpiderMiddleware'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">543</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 如果想禁用默认的中间件的话，可以设置其优先级为None</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'scrapy.spidermiddlewares.offsite.OffsiteMiddleware'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-8"><span class="crayon-p"># 配置下载中间件</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-9"><span class="crayon-v">DOWNLOADER_MIDDLEWARES</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'myproject.middlewares.RandomUserAgentMiddleware'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">543</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8a407022116-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'scrapy.contrib.downloadermiddleware.useragent.UserAgentMiddleware'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8a407022116-12"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p></p>
<h2>九、缓存</h2>
<p>scrapy默认已经自带了缓存的功能，通常我们只需要配置即可，打开<code>settings.py</code></p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd8e330977377" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
# 打开缓存
HTTPCACHE_ENABLED = True

# 设置缓存过期时间（单位：秒）
#HTTPCACHE_EXPIRATION_SECS = 0

# 缓存路径(默认为：.scrapy/httpcache)
HTTPCACHE_DIR = 'httpcache'

# 忽略的状态码
HTTPCACHE_IGNORE_HTTP_CODES = []

# 缓存模式(文件缓存)
HTTPCACHE_STORAGE = 'scrapy.extensions.httpcache.FilesystemCacheStorage'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bd8e330977377-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd8e330977377-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-1"><span class="crayon-p"># 打开缓存</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-2"><span class="crayon-v">HTTPCACHE_ENABLED</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-4"><span class="crayon-p"># 设置缓存过期时间（单位：秒）</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-5"><span class="crayon-p">#HTTPCACHE_EXPIRATION_SECS = 0</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-6">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-7"><span class="crayon-p"># 缓存路径(默认为：.scrapy/httpcache)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-8"><span class="crayon-v">HTTPCACHE_DIR</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'httpcache'</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-10"><span class="crayon-p"># 忽略的状态码</span></div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-11"><span class="crayon-v">HTTPCACHE_IGNORE_HTTP_CODES</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-12">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd8e330977377-13"><span class="crayon-p"># 缓存模式(文件缓存)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd8e330977377-14"><span class="crayon-v">HTTPCACHE_STORAGE</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'scrapy.extensions.httpcache.FilesystemCacheStorage'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p></p>
<blockquote><p>更多参数参见<a href="http://scrapy.readthedocs.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings">这里</a></p></blockquote>
<h2>十、多线程</h2>
<p>scrapy网络请求是基于Twisted，而Twisted默认支持多线程，而且scrapy默认也是通过多线程请求的，并且支持多核CPU的并发，通常只需要配置一些参数即可</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd91785901028" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
# 默认Item并发数：100
CONCURRENT_ITEMS = 100

# 默认Request并发数：16
CONCURRENT_REQUESTS = 16

# 默认每个域名的并发数：8
CONCURRENT_REQUESTS_PER_DOMAIN = 8

# 每个IP的最大并发数：0表示忽略
CONCURRENT_REQUESTS_PER_IP = 0</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd91785901028-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd91785901028-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd91785901028-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd91785901028-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd91785901028-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bd91785901028-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-1"><span class="crayon-p"># 默认Item并发数：100</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd91785901028-2"><span class="crayon-v">CONCURRENT_ITEMS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd91785901028-4"><span class="crayon-p"># 默认Request并发数：16</span></div><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-5"><span class="crayon-v">CONCURRENT_REQUESTS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd91785901028-6">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-7"><span class="crayon-p"># 默认每个域名的并发数：8</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd91785901028-8"><span class="crayon-v">CONCURRENT_REQUESTS_PER_DOMAIN</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span></div><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd91785901028-10"><span class="crayon-p"># 每个IP的最大并发数：0表示忽略</span></div><div class="crayon-line" id="crayon-5aa2982a5bd91785901028-11"><span class="crayon-v">CONCURRENT_REQUESTS_PER_IP</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
<p></p>
<blockquote><p>更多参数参见<a href="https://doc.scrapy.org/en/latest/topics/settings.html#concurrent-items">这里</a></p></blockquote>
<h2>十一、常见问题</h2>
<h3>1. 项目名称问题</h3>
<p>在使用的时候遇到过一个问题，在初始化<code>scrapy startproject tutorial</code>的时候，如果使用了一些特殊的名字，如：<code>test</code>, <code>fang</code>等单词的话，通过<code>get_project_settings</code>方法获取配置的时候会出错，改成<code>tutorial</code>或一些复杂的名字的时候不会</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd95221707265" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
ImportError: No module named tutorial.settings</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd95221707265-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd95221707265-1"><span class="crayon-v">ImportError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">No </span><span class="crayon-e">module </span><span class="crayon-e">named </span><span class="crayon-v">tutorial</span><span class="crayon-sy">.</span><span class="crayon-v">settings</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>这是一个bug，在github上有提到：<a href="https://github.com/scrapy/scrapy/issues/428">https://github.com/scrapy/scrapy/issues/428</a>，但貌似没有完全修复，修改一下名字就好了（当然<code>scrapy.cfg</code>和<code>settings.py</code>里面也需要修改）</p>
<h3>2. 为每个pipeline配置spider</h3>
<p>上面我们是在settings.py里面配置pipeline，这里的配置的pipeline会作用于所有的spider，我们可以为每一个spider配置不同的pipeline，设置<code>Spider</code>的<code>custom_settings</code>对象</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd98989434075" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
class LianjiaSpider(CrawlSpider):
    ...
    # 自定义配置
    custom_settings = {
        'ITEM_PIPELINES': {
            'tutorial.pipelines.TestPipeline.TestPipeline': 1,
        }
    }</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd98989434075-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd98989434075-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd98989434075-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd98989434075-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bd98989434075-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd98989434075-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bd98989434075-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd98989434075-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd98989434075-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">LianjiaSpider</span><span class="crayon-sy">(</span><span class="crayon-v">CrawlSpider</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd98989434075-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5aa2982a5bd98989434075-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-p"># 自定义配置</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd98989434075-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">custom_settings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5aa2982a5bd98989434075-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'ITEM_PIPELINES'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd98989434075-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'tutorial.pipelines.TestPipeline.TestPipeline'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5aa2982a5bd98989434075-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd98989434075-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
<p></p>
<h3>3. 获取提取链接的节点信息</h3>
<p>通过LinkExtractor提取的<code>scrapy.Link</code>默认不带节点信息，有时候我们需要节点的其他attribute属性，<code>scrapy.Link</code>有个<code>text</code>属性保存从节点提取的<code>text</code>值，我们可以通过修改<code>lxmlhtml._collect_string_content</code>变量为<code>etree.tostring</code>，这样可以在提取节点值就变味渲染节点<code>scrapy.Link.text</code>，然后根据<code>scrapy.Link.text</code>属性拿到节点的html，最后提取出我们需要的值</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd9c990874383" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from lxml import etree
import scrapy.linkextractors.lxmlhtml
scrapy.linkextractors.lxmlhtml._collect_string_content = etree.tostring</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd9c990874383-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd9c990874383-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd9c990874383-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd9c990874383-1"><span class="crayon-e">from </span><span class="crayon-e">lxml </span><span class="crayon-e">import </span><span class="crayon-e">etree</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd9c990874383-2"><span class="crayon-e">import </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">linkextractors</span><span class="crayon-sy">.</span><span class="crayon-e">lxmlhtml</span></div><div class="crayon-line" id="crayon-5aa2982a5bd9c990874383-3"><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-v">linkextractors</span><span class="crayon-sy">.</span><span class="crayon-v">lxmlhtml</span><span class="crayon-sy">.</span><span class="crayon-v">_collect_string_content</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">etree</span><span class="crayon-sy">.</span><span class="crayon-v">tostring</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p></p>
<h3>4. 从数据库中读取urls</h3>
<p>有时候我们已经把urls下载到数据库了，而不是在start_urls里配置，这时候可以重载spider的<code>start_requests</code>方法</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bd9f770052859" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
def start_requests(self):
    for u in self.db.session.query(User.link):
        yield Request(u.link)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bd9f770052859-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bd9f770052859-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bd9f770052859-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bd9f770052859-1"><span class="crayon-e">def </span><span class="crayon-e">start_requests</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bd9f770052859-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-v">User</span><span class="crayon-sy">.</span><span class="crayon-v">link</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bd9f770052859-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">yield </span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-v">u</span><span class="crayon-sy">.</span><span class="crayon-v">link</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>我们还可以在Request添加元数据，然后在response中访问</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bda3151616413" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
def start_requests(self):
    for u in self.db.session.query(User):
        yield Request(u.link, meta={'name': u.name})

def parse(self, response):
    print response.url, response.meta['name']</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bda3151616413-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda3151616413-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bda3151616413-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda3151616413-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bda3151616413-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda3151616413-6">6</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bda3151616413-1"><span class="crayon-e">def </span><span class="crayon-e">start_requests</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda3151616413-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">u</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">db</span><span class="crayon-sy">.</span><span class="crayon-v">session</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-v">User</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bda3151616413-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">yield </span><span class="crayon-e">Request</span><span class="crayon-sy">(</span><span class="crayon-v">u</span><span class="crayon-sy">.</span><span class="crayon-v">link</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">meta</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">u</span><span class="crayon-sy">.</span><span class="crayon-v">name</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda3151616413-4">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bda3151616413-5"><span class="crayon-e">def </span><span class="crayon-e">parse</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda3151616413-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">response</span><span class="crayon-sy">.</span><span class="crayon-v">meta</span><span class="crayon-sy">[</span><span class="crayon-s">'name'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p></p>
<h3>5. 如何进行循环爬取</h3>
<p>有时候我们需要爬取的一些经常更新的页面，例如：间隔时间为2s，爬去一个列表前10页的数据，从第一页开始爬，爬完成后重新回到第一页</p>
<p>目前的思路是，通过parse方法迭代返回Request进行增量爬取，由于scrapy默认由缓存机制，需要修改</p>
<h3>6. 关于去重</h3>
<p>scrapy默认有自己的去重机制，默认使用<code>scrapy.dupefilters.RFPDupeFilter</code>类进行去重，主要逻辑如下</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bda6280257564" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
if include_headers:
    include_headers = tuple(to_bytes(h.lower())
                             for h in sorted(include_headers))
cache = _fingerprint_cache.setdefault(request, {})
if include_headers not in cache:
    fp = hashlib.sha1()
    fp.update(to_bytes(request.method))
    fp.update(to_bytes(canonicalize_url(request.url)))
    fp.update(request.body or b'')
    if include_headers:
        for hdr in include_headers:
            if hdr in request.headers:
                fp.update(hdr)
                for v in request.headers.getlist(hdr):
                    fp.update(v)
    cache[include_headers] = fp.hexdigest()
return cache[include_headers]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-14">14</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bda6280257564-16">16</div><div class="crayon-num" data-line="crayon-5aa2982a5bda6280257564-17">17</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-1"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">include_headers</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">include_headers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">tuple</span><span class="crayon-sy">(</span><span class="crayon-e">to_bytes</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">h</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">sorted</span><span class="crayon-sy">(</span><span class="crayon-v">include_headers</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-4"><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">_fingerprint_cache</span><span class="crayon-sy">.</span><span class="crayon-e">setdefault</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-5"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">include_headers </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">hashlib</span><span class="crayon-sy">.</span><span class="crayon-e">sha1</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-e">to_bytes</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">method</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-e">to_bytes</span><span class="crayon-sy">(</span><span class="crayon-e">canonicalize_url</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">body </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-i">b</span><span class="crayon-s">''</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">include_headers</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">hdr </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">include_headers</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-e">hdr </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">hdr</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">v</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">headers</span><span class="crayon-sy">.</span><span class="crayon-e">getlist</span><span class="crayon-sy">(</span><span class="crayon-v">hdr</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-v">v</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bda6280257564-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">cache</span><span class="crayon-sy">[</span><span class="crayon-v">include_headers</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fp</span><span class="crayon-sy">.</span><span class="crayon-e">hexdigest</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bda6280257564-17"><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">[</span><span class="crayon-v">include_headers</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>默认的去重指纹是sha1(method + url + body + header)，这种方式并不能过滤很多，例如有一些请求会加上时间戳的，基本每次都会不同，这时候我们需要自定义过滤规则</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bdaa318719614" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
from scrapy.dupefilter import RFPDupeFilter

class CustomURLFilter(RFPDupeFilter):
    """ 只根据url去重"""

    def __init__(self, path=None):
        self.urls_seen = set()
        RFPDupeFilter.__init__(self, path)

    def request_seen(self, request):
        if request.url in self.urls_seen:
            return True
        else:
            self.urls_seen.add(request.url)</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-2">2</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-4">4</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-6">6</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-8">8</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-10">10</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-12">12</div><div class="crayon-num" data-line="crayon-5aa2982a5bdaa318719614-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5aa2982a5bdaa318719614-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-1"><span class="crayon-e">from </span><span class="crayon-v">scrapy</span><span class="crayon-sy">.</span><span class="crayon-e">dupefilter </span><span class="crayon-e">import </span><span class="crayon-e">RFPDupeFilter</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-2">&nbsp;</div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-3"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">CustomURLFilter</span><span class="crayon-sy">(</span><span class="crayon-v">RFPDupeFilter</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">""</span><span class="crayon-s">" 只根据url去重"</span><span class="crayon-s">""</span></div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-o">=</span><span class="crayon-v">None</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">urls_seen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">set</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">RFPDupeFilter</span><span class="crayon-sy">.</span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">path</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">def </span><span class="crayon-e">request_seen</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-e">url </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">urls_seen</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span></div><div class="crayon-line" id="crayon-5aa2982a5bdaa318719614-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5aa2982a5bdaa318719614-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">urls_seen</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-v">request</span><span class="crayon-sy">.</span><span class="crayon-v">url</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>配置setting</p><!-- Crayon Syntax Highlighter v2.7.1.1 -->

		<div id="crayon-5aa2982a5bdad961084668" class="crayon-syntax crayon-theme-github crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; font-size: 13px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 13px !important;height: 19.5px !important; line-height: 19.5px !important;"><div class="crayon-button crayon-nums-button" title="切换是否显示行编号"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="纯文本显示代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="切换自动换行"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="点击展开代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="复制代码"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="在新窗口中显示代码"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 18.2px !important; line-height: 18.2px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 13px !important; line-height: 15px !important;">
DUPEFILTER_CLASS = 'tutorial.custom_filters.CustomURLFilter'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 13px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5aa2982a5bdad961084668-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 13px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5aa2982a5bdad961084668-1"><span class="crayon-v">DUPEFILTER_CLASS</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'tutorial.custom_filters.CustomURLFilter'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p></p>
<h3>7. 如何在Pipeline中处理不同的Item</h3>
<p>scrapy所有的迭代出来的的Item都会经过所有的Pipeline，如果需要处理不同的Item，只能通过<code>isinstance()</code>方法进行类型判断，然后分别进行处理，暂时没有更好的方案</p>
<h3>8. url按顺序执行</h3>
<p>我们可以通过Request的priority控制url的请求的执行顺序，但由于网络请求的不确定性，不能保证返回也是按照顺序进行的，如果需要进行逐个url请求的话，吧url列表放在meta对象里面，在response的时候迭代返回下一个Request对象到调度器，达到顺序执行的目的，暂时没有更好的方案</p>
<h2>十二、总结</h2>
<p>scrapy虽然是最有名的python爬虫框架，但是还是有很多不足，例如，item不能单独配置给制定的pipeline，每一个爬取的所有item都会走遍所有的管道，需要在管道里面去判断不同类型的item，如果在pipelines和items比较多的项目，将会让项目变得非常臃肿</p>
<p>如有问题欢迎到<a href="http://blog.bomobox.org/2016-09-11/scrapy-start/">我的博客</a>留言</p>
<h2>十三、参考链接</h2>
<ul>
<li><a href="http://doc.scrapy.org/en/latest/index.html">官方文档</a></li>
<li><a href="https://scrapy-chs.readthedocs.org/zh_CN/0.24/intro/tutorial.html">中文教程</a></li>
<li><a href="https://segmentfault.com/a/1190000000533969">scrapy五大模块</a></li>
</ul>
</div>

        
        
        
    <div class="post-adds">
        <span data-post-id="86584" class=" btn-bluet-bigger href-style vote-post-up   register-user-only "><i class="fa  fa-thumbs-o-up"></i> <h10 id="86584votetotal">3</h10> 赞</span>
        <span data-book-type="1" data-site-id="13" data-item-id="86584" data-item-type="1" class=" btn-bluet-bigger href-style bookmark-btn  register-user-only "><i class="fa fa-bookmark-o  "></i> 14 收藏</span>

                    <a href="#article-comment"><span class="btn-bluet-bigger href-style hide-on-480"><i class="fa fa-comments-o"></i> 5 评论</span></a>
        
        
        
        <!-- JiaThis Button BEGIN -->
        <div class="jiathis_style_24x24" style="display: inline-flex; position: relative; margin: 0; clear: both;float: right;">
            <a class="jiathis_button_tsina"></a>
            <a class="jiathis_button_weixin"></a>
            <a class="jiathis_button_qzone"></a>
            <a class="jiathis_button_fb hide-on-480"></a>
            <a href="http://www.jiathis.com/share?uid=1745061" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
        </div>

    </div>




        <!-- BEGIN #author-bio -->


<!-- END #author-bio -->
	</div>
	<!-- END .entry -->


<script type="text/javascript" >
var jiathis_config={
	data_track_clickback:false,
	title:"分享从伯乐在线看到的一篇好文章 ",
	summary:"《scrapy学习笔记》",
	pic:"http://jbcdn2.b0.upaiyun.com/2016/10/c24dade2ab6bc0143a2abc9d271136d0.png",
	appkey:{
         "tsina": 1473879058    },
	ralateuid:{
		"tsina": 5305630013	},
	hideMore:false
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1745061" charset="utf-8"></script>
<!-- JiaThis Button END -->
			<div class="textwidget"><p><a href='http://group.jobbole.com/22945/' target='_blank'><img src='http://wx4.sinaimg.cn/mw690/bfdcef89gy1fknwaqrq59j20h803caau.jpg' /></a></p>
</div>
		
</div>
<!-- END .post -->
            <div style="text-align: left;">
            <h3>相关文章</h3>
            <ul style="font-size: 13px; list-style: disc inside;">
                                    <li>
                    <span class="digg-item-updated-title">
                        <a title="Scrapy 模拟登陆知乎--抓取热点话题" target="_blank" href="http://python.jobbole.com/88490/?utm_source=blog.jobbole.com&utm_medium=relatedPosts">Scrapy 模拟登陆知乎--抓取热点话题</a>
                         &middot; <a href="http://python.jobbole.com/88490/#comments" target="_blank"><i class="fa fa-comments-o"></i> 2</a>                    </span>
                    </li>
                                    <li>
                    <span class="digg-item-updated-title">
                        <a title="Python 爬虫(七)-- Scrapy 模拟登录" target="_blank" href="http://python.jobbole.com/88478/?utm_source=blog.jobbole.com&utm_medium=relatedPosts">Python 爬虫(七)-- Scrapy 模拟登录</a>
                         &middot; <a href="http://python.jobbole.com/88478/#comments" target="_blank"><i class="fa fa-comments-o"></i> 1</a>                    </span>
                    </li>
                                    <li>
                    <span class="digg-item-updated-title">
                        <a title="Python 爬虫 (六) -- Scrapy 框架学习" target="_blank" href="http://python.jobbole.com/88431/?utm_source=blog.jobbole.com&utm_medium=relatedPosts">Python 爬虫 (六) -- Scrapy 框架学习</a>
                                            </span>
                    </li>
                                    <li>
                    <span class="digg-item-updated-title">
                        <a title="爬虫模拟登录" target="_blank" href="http://python.jobbole.com/87283/?utm_source=blog.jobbole.com&utm_medium=relatedPosts">爬虫模拟登录</a>
                         &middot; <a href="http://python.jobbole.com/87283/#comments" target="_blank"><i class="fa fa-comments-o"></i> 2</a>                    </span>
                    </li>
                                    <li>
                    <span class="digg-item-updated-title">
                        <a title="Python 招聘信息爬取及可视化" target="_blank" href="http://python.jobbole.com/87387/?utm_source=blog.jobbole.com&utm_medium=relatedPosts">Python 招聘信息爬取及可视化</a>
                         &middot; <a href="http://python.jobbole.com/87387/#comments" target="_blank"><i class="fa fa-comments-o"></i> 3</a>                    </span>
                    </li>
                            </ul>
        </div>
    
    
<div style="text-align: left;">
    <h3>可能感兴趣的话题</h3>
    <ul style="font-size: 13px; list-style: disc inside;">
                        <li>
                    <a href="http://group.jobbole.com/32850/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="直播：过年7天乐，学一门新技术" target="_blank">直播：过年7天乐，学一门新技术</a>
                     &middot; <a href="http://group.jobbole.com/32850/#comments" target="_blank"><i class="fa fa-comments-o"></i> 13</a>                </li>
                            <li>
                    <a href="http://group.jobbole.com/32759/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="一个程序员在大城市，还是选择离家近的好城市呢" target="_blank">一个程序员在大城市，还是选择离家近的好城市呢</a>
                     &middot; <a href="http://group.jobbole.com/32759/#comments" target="_blank"><i class="fa fa-comments-o"></i> 15</a>                </li>
                            <li>
                    <a href="http://group.jobbole.com/32748/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="怎样判断一个公司有没有发展前景？" target="_blank">怎样判断一个公司有没有发展前景？</a>
                     &middot; <a href="http://group.jobbole.com/32748/#comments" target="_blank"><i class="fa fa-comments-o"></i> 33</a>                </li>
                            <li>
                    <a href="http://group.jobbole.com/32745/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="该如何学习机器学习以及一些算法？" target="_blank">该如何学习机器学习以及一些算法？</a>
                     &middot; <a href="http://group.jobbole.com/32745/#comments" target="_blank"><i class="fa fa-comments-o"></i> 9</a>                </li>
                            <li>
                    <a href="http://group.jobbole.com/32730/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="ecstore 商城架构" target="_blank">ecstore 商城架构</a>
                                    </li>
                            <li>
                    <a href="http://group.jobbole.com/32714/?utm_source=python.jobbole.com&utm_medium=article-related-group-topic" title="iOS APP 上架被拒，求助" target="_blank">iOS APP 上架被拒，求助</a>
                     &middot; <a href="http://group.jobbole.com/32714/#comments" target="_blank"><i class="fa fa-comments-o"></i> 2</a>                </li>
                </ul>
</div>
	
            <div id="article-comment" class="dot-box center-align">

                        <a href="http://www.jobbole.com/login?redirect=http://python.jobbole.com/86584/"><button type="button" class="btn btn-non-transparent">登录后评论</button></a>
            
            <a target="_blank" href="http://www.jobbole.com/register"><button type="button" class="btn btn-primary">新用户注册</button></a>

            <br/><br/>
            <span>直接登录</span>
            <style type="text/css">.t_login_text{margin:0; padding:0;}.t_login_button{margin:0; padding: 5px 0;}.t_login_button a{margin:0; padding-right:3px; line-height:25px}.t_login_button img{display:inline; border:none;}</style><!-- 使用社交帐号登录 来自 WordPress连接微博 插件 --><span class="connectBox1 t_login_button"><a href="http://python.jobbole.com/wp-content/plugins/wp-connect/login.php?go=weixin&redirect_url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" title="微信" rel="nofollow"><img src="http://python.jobbole.com/wp-content/plugins/wp-connect/images/login/btn_weixin.png" /></a><a href="http://python.jobbole.com/wp-content/plugins/wp-connect/login.php?go=qzone&redirect_url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" title="QQ" rel="nofollow"><img src="http://python.jobbole.com/wp-content/plugins/wp-connect/images/login/btn_qzone.png" /></a><a href="http://python.jobbole.com/wp-content/plugins/wp-connect/login.php?go=sina&redirect_url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" title="新浪微博" rel="nofollow"><img src="http://python.jobbole.com/wp-content/plugins/wp-connect/images/login/btn_sina.png" /></a><a href="http://python.jobbole.com/wp-content/plugins/wp-connect/login.php?go=douban&redirect_url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" title="豆瓣" rel="nofollow"><img src="http://python.jobbole.com/wp-content/plugins/wp-connect/images/login/btn_douban.png" /></a><a href="http://python.jobbole.com/wp-content/plugins/wp-connect/login.php?go=github&redirect_url=http%3A%2F%2Fpython.jobbole.com%2F86584%2F" title="GitHub" rel="nofollow"><img src="http://python.jobbole.com/wp-content/plugins/wp-connect/images/login/btn_github.png" /></a></span>        </div>
    

    <div id="comment_list" class="comments">

                    <h5 id="comments" class="sub-title"><i class="glyphicon"></i>最新评论</h5>
            <ul class="cmnt-list">

                        <li id="comment-94112"  class="comment cmnt odd">
    
    <div class="cmnt-box">
        <div class="cmnt-header">
                            <a href="http://www.jobbole.com/members/q1339871972" class="cmnt-img"><img width="37" height="37" src="http://jbcdn2.b0.upaiyun.com/2016/12/770910da578bd345e7d28046ab9d72ec.jpg" alt=""></a>
                <div class="cmnt-meta">
                    <span><a href="http://www.jobbole.com/members/q1339871972">若风chr</a><label class="comment_author_data">&nbsp;（ <a title='声望值' target='_blank' href='http://www.jobbole.com/members/q1339871972/reputation/'><i class='fa fa-graduation-cap'></i> 1</a> ）</label></span>
                    <span class="c-title">
                        代码农民工                    </span>

                    <span class="c-date">
                        <a href="http://python.jobbole.com/86584/#comment-94112">2016/10/14</a>
                    </span>

                    
                    
                </div>
                    </div>
        <div class="cmnt-body">
            <p>
                <p>好东西啊，谢谢分享</p>
            </p>
                    </div>
                    <div class="cmnt-footer">

                
                <p class="c-like">
                    <a title="赞同" alt="赞同" class="94112voteflag  t-up  href-style vote-comment-up  register-user-only   " data-comment-id="94112"><i class="fa fa-thumbs-o-up"></i> <span id="94112voteuptotal"> 赞</span></a>

                    
                    <a rel='nofollow' class='comment-reply-link register-user-only' href='http://python.jobbole.com/86584/?replytocom=94112#respond' data-onclick='return addComment.moveForm( "comment-94112", "94112", "respond", "86584" )' aria-label='回复给清枫'>回复 <i class='fa fa-reply'></i></a>
                </p>
            </div>
            </div>
    </li>
</li><!-- #comment-## -->
        <li id="comment-94114"  class="comment cmnt even">
    
    <div class="cmnt-box">
        <div class="cmnt-header">
                            <a href="http://www.jobbole.com/members/Annina1994" class="cmnt-img"><img width="37" height="37" src="http://jbcdn2.b0.upaiyun.com/2016/10/7b513e478817b9899b90b1d5a0614ebf.jpg" alt=""></a>
                <div class="cmnt-meta">
                    <span><a href="http://www.jobbole.com/members/Annina1994">Lady L</a><label class="comment_author_data">&nbsp;（ <a title='声望值' target='_blank' href='http://www.jobbole.com/members/Annina1994/reputation/'><i class='fa fa-graduation-cap'></i> 1</a> &middot; <a title='我的网站' target='_blank' href='http://www.annalife.club'><i class='fa fa-link'></i></a>&nbsp;<a title='QQ：1402779770' target='_blank' href='#'><i class='fa fa-qq'></i></a>&nbsp;<a title='GitHub主页' target='_blank' href='https://github.com/Canace22/Canac22'><i class='fa fa-github'></i></a>&nbsp; ）</label></span>
                    <span class="c-title">
                        web前端                    </span>

                    <span class="c-date">
                        <a href="http://python.jobbole.com/86584/#comment-94114">2016/10/14</a>
                    </span>

                    
                    
                </div>
                    </div>
        <div class="cmnt-body">
            <p>
                <p>可以，怎么没有win下的呢？</p>
            </p>
                    </div>
                    <div class="cmnt-footer">

                
                <p class="c-like">
                    <a title="赞同" alt="赞同" class="94114voteflag  t-up  href-style vote-comment-up  register-user-only   " data-comment-id="94114"><i class="fa fa-thumbs-o-up"></i> <span id="94114voteuptotal"> 赞</span></a>

                    
                    <a rel='nofollow' class='comment-reply-link register-user-only' href='http://python.jobbole.com/86584/?replytocom=94114#respond' data-onclick='return addComment.moveForm( "comment-94114", "94114", "respond", "86584" )' aria-label='回复给Lady L'>回复 <i class='fa fa-reply'></i></a>
                </p>
            </div>
            </div>
    </li>
<ul class="children">
        <li id="comment-94115"  class="comment cmnt odd">
    
    <div class="cmnt-box">
        <div class="cmnt-header">
                            <a href="http://www.jobbole.com/members/crazyrabbit" class="cmnt-img"><img width="37" height="37" src="http://jbcdn2.b0.upaiyun.com/2016/10/4c83a3aa65cb2210cf0e5fef83df20b0.jpg" alt=""></a>
                <div class="cmnt-meta">
                    <span><a href="http://www.jobbole.com/members/crazyrabbit">疯狂的兔子</a><label class="comment_author_data">&nbsp;（ <a title='声望值' target='_blank' href='http://www.jobbole.com/members/crazyrabbit/reputation/'><i class='fa fa-graduation-cap'></i> 1</a> &middot; <a title='我的网站' target='_blank' href='http://blog.turbo123.win/'><i class='fa fa-link'></i></a>&nbsp; ）</label></span>
                    <span class="c-title">
                        python                    </span>

                    <span class="c-date">
                        <a href="http://python.jobbole.com/86584/#comment-94115">2016/10/15</a>
                    </span>

                    
                    
                </div>
                    </div>
        <div class="cmnt-body">
            <p>
                <p>win下不能用，哈哈哈</p>
            </p>
                    </div>
                    <div class="cmnt-footer">

                
                <p class="c-like">
                    <a title="赞同" alt="赞同" class="94115voteflag  t-up  href-style vote-comment-up  register-user-only   " data-comment-id="94115"><i class="fa fa-thumbs-o-up"></i> <span id="94115voteuptotal"> 赞</span></a>

                    
                    <a rel='nofollow' class='comment-reply-link register-user-only' href='http://python.jobbole.com/86584/?replytocom=94115#respond' data-onclick='return addComment.moveForm( "comment-94115", "94115", "respond", "86584" )' aria-label='回复给疯狂的兔子'>回复 <i class='fa fa-reply'></i></a>
                </p>
            </div>
            </div>
    </li>
<ul class="children">
        <li id="comment-94118"  class="comment cmnt even">
    
    <div class="cmnt-box">
        <div class="cmnt-header">
                            <a href="http://www.jobbole.com/members/boshi728" class="cmnt-img"><img width="37" height="37" src="http://jbcdn2.b0.upaiyun.com/2015/04/8fbdaaa5ea6d3b49c8c1c825aafeb5d9.png" alt=""></a>
                <div class="cmnt-meta">
                    <span><a href="http://www.jobbole.com/members/boshi728">木糖醇</a><label class="comment_author_data">&nbsp;</label></span>
                    <span class="c-title">
                        &nbsp;                    </span>

                    <span class="c-date">
                        <a href="http://python.jobbole.com/86584/#comment-94118">2016/10/16</a>
                    </span>

                    
                    
                </div>
                    </div>
        <div class="cmnt-body">
            <p>
                <p>YUY,   winXP,win7,win10都用过</p>
            </p>
                    </div>
                    <div class="cmnt-footer">

                
                <p class="c-like">
                    <a title="赞同" alt="赞同" class="94118voteflag  t-up  href-style vote-comment-up  register-user-only   " data-comment-id="94118"><i class="fa fa-thumbs-o-up"></i> <span id="94118voteuptotal"> 赞</span></a>

                    
                    <a rel='nofollow' class='comment-reply-link register-user-only' href='http://python.jobbole.com/86584/?replytocom=94118#respond' data-onclick='return addComment.moveForm( "comment-94118", "94118", "respond", "86584" )' aria-label='回复给木糖醇'>回复 <i class='fa fa-reply'></i></a>
                </p>
            </div>
            </div>
    </li>
<ul class="children">
        <li id="comment-94119"  class="comment cmnt odd">
    
    <div class="cmnt-box">
        <div class="cmnt-header">
                            <a href="http://www.jobbole.com/members/crazyrabbit" class="cmnt-img"><img width="37" height="37" src="http://jbcdn2.b0.upaiyun.com/2016/10/4c83a3aa65cb2210cf0e5fef83df20b0.jpg" alt=""></a>
                <div class="cmnt-meta">
                    <span><a href="http://www.jobbole.com/members/crazyrabbit">疯狂的兔子</a><label class="comment_author_data">&nbsp;（ <a title='声望值' target='_blank' href='http://www.jobbole.com/members/crazyrabbit/reputation/'><i class='fa fa-graduation-cap'></i> 1</a> &middot; <a title='我的网站' target='_blank' href='http://blog.turbo123.win/'><i class='fa fa-link'></i></a>&nbsp; ）</label></span>
                    <span class="c-title">
                        python                    </span>

                    <span class="c-date">
                        <a href="http://python.jobbole.com/86584/#comment-94119">2016/10/16</a>
                    </span>

                    
                    
                </div>
                    </div>
        <div class="cmnt-body">
            <p>
                <p>哈哈哈</p>
            </p>
                    </div>
                    <div class="cmnt-footer">

                
                <p class="c-like">
                    <a title="赞同" alt="赞同" class="94119voteflag  t-up  href-style vote-comment-up  register-user-only   " data-comment-id="94119"><i class="fa fa-thumbs-o-up"></i> <span id="94119voteuptotal"> 赞</span></a>

                    
                    <a rel='nofollow' class='comment-reply-link register-user-only' href='http://python.jobbole.com/86584/?replytocom=94119#respond' data-onclick='return addComment.moveForm( "comment-94119", "94119", "respond", "86584" )' aria-label='回复给疯狂的兔子'>回复 <i class='fa fa-reply'></i></a>
                </p>
            </div>
            </div>
    </li>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
            </ul>
        
    </div>
		

	
</div>
<!-- END .grid-8 -->

<!-- BEGIN #sidebar -->
<div id="sidebar" class="grid-4">

	    <div id="text-2" class="widget widget_text">			<div class="textwidget"><p><a href="http://group.jobbole.com/22945/" target="_blank"><img src="http://wx3.sinaimg.cn/mw690/bfdcef89gy1fknwan427yj208c06y3z9.jpg" /></a></p>
</div>
		</div>
        <h3 class="widget-title">
            <a target="_blank" href="http://group.jobbole.com/category/tech/python/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topics-more">Python小组话题</a>
            <span style="float:right;"><a target="_blank" href="http://group.jobbole.com/newtopic/?group=15">我有新话题 <i class='fa fa-commenting-o'></i></a></span>
        </h3>

        <!-- BEGIN .container -->
        <div class="container">

            
                <!-- BEGIN .grid-4 -->
                <div class="grid-4 floated-thumb">

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/wx3085091357" ">
                                    <img src="http://jbcdn2.b0.upaiyun.com/2017/11/a8e0d2221917925675e4eff2e2a9b2fc.jpg" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="Python学习，有哪些方向可以选择" href="http://group.jobbole.com/32125/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">Python学习，有哪些方向可以选择</a><br />
                                <a href="http://group.jobbole.com/author/wx3085091357/">小丑的哭笑</a> 发起
                                                                    • 30 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/q4195729723" ">
                                    <img src="http://q.qlogo.cn/qqapp/208656/4969850473D76805F067B3508036F5CA/100" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="2年Java，想转 python" href="http://group.jobbole.com/32295/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">2年Java，想转 python</a><br />
                                <a href="http://group.jobbole.com/author/q4195729723/">大概会吧</a> 发起
                                                                    • 16 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/q4148319794" ">
                                    <img src="http://q.qlogo.cn/qqapp/208656/F7437765159D07B62E1E6EAC0704252B/100" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="python 真的能在人工智能领域 一骑绝尘吗 ？" href="http://group.jobbole.com/32372/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">python 真的能在人工智能领域 一骑...</a><br />
                                <a href="http://group.jobbole.com/author/q4148319794/">✎﹏泽恒</a> 发起
                                                                    • 9 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/81513950" ">
                                    <img src="http://img3.douban.com/icon/u81513950-1.jpg" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="零基础自学Python感觉很难，不像大家说的那么简单" href="http://group.jobbole.com/17537/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">零基础自学Python感觉很难，不像大...</a><br />
                                <a href="http://group.jobbole.com/author/81513950/">keepcalm</a> 发起
                                                                    • 93 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/wx1874786499" ">
                                    <img src="http://jbcdn2.b0.upaiyun.com/2015/04/8fbdaaa5ea6d3b49c8c1c825aafeb5d9.png" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="有關 pandas 的問題" href="http://group.jobbole.com/32699/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">有關 pandas 的問題</a><br />
                                <a href="http://group.jobbole.com/author/wx1874786499/">許秉凱</a> 发起
                                                                    • 2 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                            <!-- BEGIN .post-thumb -->
                            <div class="author-thumb">

                                <a target="_blank" href="http://www.jobbole.com/members/faiwong" ">
                                    <img src="http://jbcdn2.b0.upaiyun.com/2017/03/bcb7c947845ca036310d3b02734e10e4.jpg" alt="" width="34" height="34" />
                                </a>

                            </div>
                            <!-- END .post-thumb -->

                        <!-- BEGIN .post-meta -->
                        <div class="post-meta">

                            <p>
                                <a class="meta-title" target="_blank" title="做自己喜欢的事情成本有多高？" href="http://group.jobbole.com/31543/?utm_source=python.jobbole.com&utm_medium=sidebar-group-topic">做自己喜欢的事情成本有多高？</a><br />
                                <a href="http://group.jobbole.com/author/faiwong/">北冥有沙丁鱼</a> 发起
                                                                    • 56 回复
                                
                            </p>

                        </div>
                        <!-- END .post-meta -->

                        <div class="clear"></div>

                    
                </div>
                <!-- END .grid-4 -->

            
            <div class="clear"></div>

        </div>
        <!-- END .container -->

        <div id="text-11" class="widget widget_text">			<div class="textwidget"><p><a href="http://blog.jobbole.com/106093/" target="_blank"><img src="http://ww2.sinaimg.cn/mw690/bfdcef89gw1f9cf776pjmj208c03c3yt.jpg" /></a></p>
</div>
		</div><div class="tabs tabbed_widget"><ul class="nav clearfix"><li><a id="link-tab1" href="#tab1" title="本周热门Python文章">本周热门Python文章</a></li><li><a id="link-tab2" href="#tab2" title="本月热门">本月热门</a></li><li><a id="link-tab3" href="#tab3" title="热门标签">热门标签</a></li></ul><div id="tab1" class="tab"><div class="floated-thumb">
                    
                    <!-- BEGIN .post-meta -->
                    <div class="post-meta  no-thumb">

                        <p>
                            <span class="numb">0</span>
                            <a class="meta-title" target="_blank" href="http://python.jobbole.com/89007/" title="一篇文章教你如何用 Python 记录日志">一篇文章教你如何用 Python 记录...</a><br />
                        </p>

                    </div>
                    <!-- END .post-meta -->

                    <div class="clear"></div>

                </div></div><div id="tab2" class="tab"><div class="floated-thumb">
                    
                    <!-- BEGIN .post-meta -->
                    <div class="post-meta  no-thumb">

                        <p>
                            <span class="numb">0</span>
                            <a class="meta-title" target="_blank" href="http://python.jobbole.com/89007/" title="一篇文章教你如何用 Python 记录日志">一篇文章教你如何用 Python 记录...</a><br />
                        </p>

                    </div>
                    <!-- END .post-meta -->

                    <div class="clear"></div>

                </div></div><div id="tab3" class="tab"><p><a href='http://python.jobbole.com/tag/api/' class='tag-link-1197 tag-link-position-1' title='5个话题' style='font-size: 8.6222222222222px;'>API</a>
<a href='http://python.jobbole.com/tag/beautifulsoup/' class='tag-link-1153 tag-link-position-2' title='4个话题' style='font-size: 8px;'>beautifulsoup</a>
<a href='http://python.jobbole.com/tag/celery/' class='tag-link-846 tag-link-position-3' title='7个话题' style='font-size: 9.5555555555556px;'>Celery</a>
<a href='http://python.jobbole.com/tag/django/' class='tag-link-674 tag-link-position-4' title='34个话题' style='font-size: 14.533333333333px;'>Django</a>
<a href='http://python.jobbole.com/tag/featuredpost/' class='tag-link-666 tag-link-position-5' title='5个话题' style='font-size: 8.6222222222222px;'>featuredpost</a>
<a href='http://python.jobbole.com/tag/flask/' class='tag-link-695 tag-link-position-6' title='69个话题' style='font-size: 16.944444444444px;'>Flask</a>
<a href='http://python.jobbole.com/tag/gdb/' class='tag-link-877 tag-link-position-7' title='6个话题' style='font-size: 9.1666666666667px;'>GDB</a>
<a href='http://python.jobbole.com/tag/gevent/' class='tag-link-1085 tag-link-position-8' title='6个话题' style='font-size: 9.1666666666667px;'>gevent</a>
<a href='http://python.jobbole.com/tag/gil/' class='tag-link-831 tag-link-position-9' title='6个话题' style='font-size: 9.1666666666667px;'>GIL</a>
<a href='http://python.jobbole.com/tag/import/' class='tag-link-906 tag-link-position-10' title='4个话题' style='font-size: 8px;'>import</a>
<a href='http://python.jobbole.com/tag/itertools/' class='tag-link-1052 tag-link-position-11' title='6个话题' style='font-size: 9.1666666666667px;'>itertools</a>
<a href='http://python.jobbole.com/tag/linux/' class='tag-link-684 tag-link-position-12' title='5个话题' style='font-size: 8.6222222222222px;'>Linux</a>
<a href='http://python.jobbole.com/tag/logging/' class='tag-link-799 tag-link-position-13' title='6个话题' style='font-size: 9.1666666666667px;'>logging</a>
<a href='http://python.jobbole.com/tag/matplotlib/' class='tag-link-735 tag-link-position-14' title='7个话题' style='font-size: 9.5555555555556px;'>matplotlib</a>
<a href='http://python.jobbole.com/tag/mongodb/' class='tag-link-753 tag-link-position-15' title='10个话题' style='font-size: 10.644444444444px;'>MongoDB</a>
<a href='http://python.jobbole.com/tag/mysql/' class='tag-link-722 tag-link-position-16' title='8个话题' style='font-size: 9.9444444444444px;'>MySQL</a>
<a href='http://python.jobbole.com/tag/nginx/' class='tag-link-1081 tag-link-position-17' title='7个话题' style='font-size: 9.5555555555556px;'>Nginx</a>
<a href='http://python.jobbole.com/tag/nlp/' class='tag-link-766 tag-link-position-18' title='5个话题' style='font-size: 8.6222222222222px;'>NLP</a>
<a href='http://python.jobbole.com/tag/numpy/' class='tag-link-757 tag-link-position-19' title='6个话题' style='font-size: 9.1666666666667px;'>NumPy</a>
<a href='http://python.jobbole.com/tag/oop/' class='tag-link-1371 tag-link-position-20' title='5个话题' style='font-size: 8.6222222222222px;'>oop</a>
<a href='http://python.jobbole.com/tag/opencv/' class='tag-link-681 tag-link-position-21' title='27个话题' style='font-size: 13.833333333333px;'>OpenCV</a>
<a href='http://python.jobbole.com/tag/orm/' class='tag-link-1024 tag-link-position-22' title='6个话题' style='font-size: 9.1666666666667px;'>ORM</a>
<a href='http://python.jobbole.com/tag/pandas/' class='tag-link-685 tag-link-position-23' title='11个话题' style='font-size: 10.955555555556px;'>Pandas</a>
<a href='http://python.jobbole.com/tag/pyenv/' class='tag-link-1128 tag-link-position-24' title='4个话题' style='font-size: 8px;'>pyenv</a>
<a href='http://python.jobbole.com/tag/pygame/' class='tag-link-851 tag-link-position-25' title='40个话题' style='font-size: 15.077777777778px;'>pyGame</a>
<a href='http://python.jobbole.com/tag/pyspider/' class='tag-link-721 tag-link-position-26' title='5个话题' style='font-size: 8.6222222222222px;'>Pyspider</a>
<a href='http://python.jobbole.com/tag/python/' class='tag-link-663 tag-link-position-27' title='316个话题' style='font-size: 22px;'>Python</a>
<a href='http://python.jobbole.com/tag/python%e6%ba%90%e7%a0%81/' class='tag-link-931 tag-link-position-28' title='6个话题' style='font-size: 9.1666666666667px;'>python源码</a>
<a href='http://python.jobbole.com/tag/r/' class='tag-link-1165 tag-link-position-29' title='6个话题' style='font-size: 9.1666666666667px;'>R</a>
<a href='http://python.jobbole.com/tag/restful/' class='tag-link-1057 tag-link-position-30' title='7个话题' style='font-size: 9.5555555555556px;'>restful</a>
<a href='http://python.jobbole.com/tag/scikit-learn/' class='tag-link-826 tag-link-position-31' title='5个话题' style='font-size: 8.6222222222222px;'>Scikit-Learn</a>
<a href='http://python.jobbole.com/tag/scrapy/' class='tag-link-752 tag-link-position-32' title='25个话题' style='font-size: 13.522222222222px;'>Scrapy</a>
<a href='http://python.jobbole.com/tag/setuptools/' class='tag-link-1130 tag-link-position-33' title='5个话题' style='font-size: 8.6222222222222px;'>setuptools</a>
<a href='http://python.jobbole.com/tag/socket/' class='tag-link-820 tag-link-position-34' title='10个话题' style='font-size: 10.644444444444px;'>Socket</a>
<a href='http://python.jobbole.com/tag/spark/' class='tag-link-875 tag-link-position-35' title='4个话题' style='font-size: 8px;'>Spark</a>
<a href='http://python.jobbole.com/tag/sqlalchemy/' class='tag-link-893 tag-link-position-36' title='10个话题' style='font-size: 10.644444444444px;'>SQLAlchemy</a>
<a href='http://python.jobbole.com/tag/tensorflow/' class='tag-link-1406 tag-link-position-37' title='8个话题' style='font-size: 9.9444444444444px;'>tensorflow</a>
<a href='http://python.jobbole.com/tag/tornado/' class='tag-link-867 tag-link-position-38' title='17个话题' style='font-size: 12.355555555556px;'>Tornado</a>
<a href='http://python.jobbole.com/tag/vim/' class='tag-link-1040 tag-link-position-39' title='5个话题' style='font-size: 8.6222222222222px;'>Vim</a>
<a href='http://python.jobbole.com/tag/virtualenv/' class='tag-link-1249 tag-link-position-40' title='8个话题' style='font-size: 9.9444444444444px;'>virtualenv</a>
<a href='http://python.jobbole.com/tag/web/' class='tag-link-1095 tag-link-position-41' title='7个话题' style='font-size: 9.5555555555556px;'>web</a>
<a href='http://python.jobbole.com/tag/web%e5%bc%80%e5%8f%91/' class='tag-link-1515 tag-link-position-42' title='6个话题' style='font-size: 9.1666666666667px;'>web开发</a>
<a href='http://python.jobbole.com/tag/web%e6%9c%8d%e5%8a%a1%e5%99%a8/' class='tag-link-800 tag-link-position-43' title='5个话题' style='font-size: 8.6222222222222px;'>Web服务器</a>
<a href='http://python.jobbole.com/tag/werkzeug/' class='tag-link-1149 tag-link-position-44' title='4个话题' style='font-size: 8px;'>werkzeug</a>
<a href='http://python.jobbole.com/tag/wsgi/' class='tag-link-1077 tag-link-position-45' title='9个话题' style='font-size: 10.333333333333px;'>WSGI</a>
<a href='http://python.jobbole.com/tag/xml/' class='tag-link-921 tag-link-position-46' title='4个话题' style='font-size: 8px;'>XML</a>
<a href='http://python.jobbole.com/tag/%e4%bd%9c%e7%94%a8%e5%9f%9f/' class='tag-link-747 tag-link-position-47' title='5个话题' style='font-size: 8.6222222222222px;'>作用域</a>
<a href='http://python.jobbole.com/tag/%e5%85%83%e7%b1%bb/' class='tag-link-1194 tag-link-position-48' title='7个话题' style='font-size: 9.5555555555556px;'>元类</a>
<a href='http://python.jobbole.com/tag/%e5%86%b3%e7%ad%96%e6%a0%91/' class='tag-link-1161 tag-link-position-49' title='6个话题' style='font-size: 9.1666666666667px;'>决策树</a>
<a href='http://python.jobbole.com/tag/%e5%87%bd%e6%95%b0/' class='tag-link-741 tag-link-position-50' title='7个话题' style='font-size: 9.5555555555556px;'>函数</a>
<a href='http://python.jobbole.com/tag/%e5%87%bd%e6%95%b0%e5%bc%8f%e7%bc%96%e7%a8%8b/' class='tag-link-711 tag-link-position-51' title='12个话题' style='font-size: 11.188888888889px;'>函数式编程</a>
<a href='http://python.jobbole.com/tag/%e5%88%97%e8%a1%a8/' class='tag-link-900 tag-link-position-52' title='5个话题' style='font-size: 8.6222222222222px;'>列表</a>
<a href='http://python.jobbole.com/tag/%e5%8d%8f%e7%a8%8b/' class='tag-link-1043 tag-link-position-53' title='17个话题' style='font-size: 12.355555555556px;'>协程</a>
<a href='http://python.jobbole.com/tag/%e5%9b%be%e5%83%8f%e5%a4%84%e7%90%86/' class='tag-link-1191 tag-link-position-54' title='12个话题' style='font-size: 11.188888888889px;'>图像处理</a>
<a href='http://python.jobbole.com/tag/%e5%9e%83%e5%9c%be%e5%9b%9e%e6%94%b6/' class='tag-link-864 tag-link-position-55' title='6个话题' style='font-size: 9.1666666666667px;'>垃圾回收</a>
<a href='http://python.jobbole.com/tag/%e5%a4%9a%e7%ba%bf%e7%a8%8b/' class='tag-link-1090 tag-link-position-56' title='15个话题' style='font-size: 11.888888888889px;'>多线程</a>
<a href='http://python.jobbole.com/tag/%e5%a4%9a%e8%bf%9b%e7%a8%8b/' class='tag-link-667 tag-link-position-57' title='12个话题' style='font-size: 11.188888888889px;'>多进程</a>
<a href='http://python.jobbole.com/tag/%e5%ad%97%e5%85%b8/' class='tag-link-1206 tag-link-position-58' title='4个话题' style='font-size: 8px;'>字典</a>
<a href='http://python.jobbole.com/tag/%e5%ad%97%e7%ac%a6%e4%b8%b2/' class='tag-link-882 tag-link-position-59' title='8个话题' style='font-size: 9.9444444444444px;'>字符串</a>
<a href='http://python.jobbole.com/tag/%e5%ad%97%e7%ac%a6%e7%bc%96%e7%a0%81/' class='tag-link-868 tag-link-position-60' title='8个话题' style='font-size: 9.9444444444444px;'>字符编码</a>
<a href='http://python.jobbole.com/tag/%e5%ae%89%e5%85%a8/' class='tag-link-917 tag-link-position-61' title='4个话题' style='font-size: 8px;'>安全</a>
<a href='http://python.jobbole.com/tag/%e5%b9%b6%e5%8f%91/' class='tag-link-699 tag-link-position-62' title='6个话题' style='font-size: 9.1666666666667px;'>并发</a>
<a href='http://python.jobbole.com/tag/%e5%b9%b6%e8%a1%8c/' class='tag-link-746 tag-link-position-63' title='12个话题' style='font-size: 11.188888888889px;'>并行</a>
<a href='http://python.jobbole.com/tag/%e5%bc%82%e6%ad%a5/' class='tag-link-1003 tag-link-position-64' title='15个话题' style='font-size: 11.888888888889px;'>异步</a>
<a href='http://python.jobbole.com/tag/%e5%be%ae%e4%bf%a1/' class='tag-link-1016 tag-link-position-65' title='5个话题' style='font-size: 8.6222222222222px;'>微信</a>
<a href='http://python.jobbole.com/tag/%e6%80%a7%e8%83%bd/' class='tag-link-706 tag-link-position-66' title='6个话题' style='font-size: 9.1666666666667px;'>性能</a>
<a href='http://python.jobbole.com/tag/%e6%80%a7%e8%83%bd%e5%88%86%e6%9e%90/' class='tag-link-1216 tag-link-position-67' title='4个话题' style='font-size: 8px;'>性能分析</a>
<a href='http://python.jobbole.com/tag/%e6%8f%8f%e8%bf%b0%e7%ac%a6/' class='tag-link-742 tag-link-position-68' title='9个话题' style='font-size: 10.333333333333px;'>描述符</a>
<a href='http://python.jobbole.com/tag/%e6%95%99%e7%a8%8b/' class='tag-link-894 tag-link-position-69' title='57个话题' style='font-size: 16.244444444444px;'>教程</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e5%88%86%e6%9e%90/' class='tag-link-700 tag-link-position-70' title='12个话题' style='font-size: 11.188888888889px;'>数据分析</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e5%8f%af%e8%a7%86%e5%8c%96/' class='tag-link-723 tag-link-position-71' title='8个话题' style='font-size: 9.9444444444444px;'>数据可视化</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e6%8c%96%e6%8e%98/' class='tag-link-732 tag-link-position-72' title='7个话题' style='font-size: 9.5555555555556px;'>数据挖掘</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e7%a7%91%e5%ad%a6/' class='tag-link-680 tag-link-position-73' title='8个话题' style='font-size: 9.9444444444444px;'>数据科学</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84/' class='tag-link-1228 tag-link-position-74' title='5个话题' style='font-size: 8.6222222222222px;'>数据结构</a>
<a href='http://python.jobbole.com/tag/%e6%95%b0%e6%8d%ae%e7%bb%93%e6%9e%84%e4%b8%8e%e7%ae%97%e6%b3%95/' class='tag-link-1237 tag-link-position-75' title='10个话题' style='font-size: 10.644444444444px;'>数据结构与算法</a>
<a href='http://python.jobbole.com/tag/machinelearning/' class='tag-link-703 tag-link-position-76' title='57个话题' style='font-size: 16.244444444444px;'>机器学习</a>
<a href='http://python.jobbole.com/tag/%e6%a0%87%e5%87%86%e5%ba%93/' class='tag-link-1053 tag-link-position-77' title='6个话题' style='font-size: 9.1666666666667px;'>标准库</a>
<a href='http://python.jobbole.com/tag/%e6%a0%91%e5%bd%a2%e7%bb%93%e6%9e%84/' class='tag-link-1245 tag-link-position-78' title='6个话题' style='font-size: 9.1666666666667px;'>树形结构</a>
<a href='http://python.jobbole.com/tag/%e6%ad%a3%e5%88%99%e8%a1%a8%e8%be%be%e5%bc%8f/' class='tag-link-1219 tag-link-position-79' title='8个话题' style='font-size: 9.9444444444444px;'>正则表达式</a>
<a href='http://python.jobbole.com/tag/%e6%b7%b1%e5%ba%a6%e5%ad%a6%e4%b9%a0/' class='tag-link-838 tag-link-position-80' title='6个话题' style='font-size: 9.1666666666667px;'>深度学习</a>
<a href='http://python.jobbole.com/tag/%e6%b8%b8%e6%88%8f%e7%bc%96%e7%a8%8b/' class='tag-link-1308 tag-link-position-81' title='9个话题' style='font-size: 10.333333333333px;'>游戏编程</a>
<a href='http://python.jobbole.com/tag/%e7%88%ac%e8%99%ab/' class='tag-link-714 tag-link-position-82' title='95个话题' style='font-size: 17.955555555556px;'>爬虫</a>
<a href='http://python.jobbole.com/tag/%e7%94%9f%e6%88%90%e5%99%a8/' class='tag-link-837 tag-link-position-83' title='13个话题' style='font-size: 11.5px;'>生成器</a>
<a href='http://python.jobbole.com/tag/%e7%a5%9e%e7%bb%8f%e7%bd%91%e7%bb%9c/' class='tag-link-749 tag-link-position-84' title='10个话题' style='font-size: 10.644444444444px;'>神经网络</a>
<a href='http://python.jobbole.com/tag/%e7%ae%97%e6%b3%95/' class='tag-link-772 tag-link-position-85' title='14个话题' style='font-size: 11.733333333333px;'>算法</a>
<a href='http://python.jobbole.com/tag/%e7%b1%bb/' class='tag-link-719 tag-link-position-86' title='7个话题' style='font-size: 9.5555555555556px;'>类</a>
<a href='http://python.jobbole.com/tag/%e7%ba%bf%e6%80%a7%e5%9b%9e%e5%bd%92/' class='tag-link-743 tag-link-position-87' title='5个话题' style='font-size: 8.6222222222222px;'>线性回归</a>
<a href='http://python.jobbole.com/tag/%e7%ba%bf%e7%a8%8b/' class='tag-link-698 tag-link-position-88' title='4个话题' style='font-size: 8px;'>线程</a>
<a href='http://python.jobbole.com/tag/%e7%bc%96%e7%a0%81/' class='tag-link-673 tag-link-position-89' title='11个话题' style='font-size: 10.955555555556px;'>编码</a>
<a href='http://python.jobbole.com/tag/%e7%bd%91%e7%bb%9c%e7%88%ac%e8%99%ab/' class='tag-link-1451 tag-link-position-90' title='4个话题' style='font-size: 8px;'>网络爬虫</a>
<a href='http://python.jobbole.com/tag/%e7%bd%91%e9%a1%b5%e7%88%ac%e8%99%ab/' class='tag-link-729 tag-link-position-91' title='7个话题' style='font-size: 9.5555555555556px;'>网页爬虫</a>
<a href='http://python.jobbole.com/tag/%e8%81%9a%e7%b1%bb/' class='tag-link-950 tag-link-position-92' title='4个话题' style='font-size: 8px;'>聚类</a>
<a href='http://python.jobbole.com/tag/%e8%a3%85%e9%a5%b0%e5%99%a8/' class='tag-link-718 tag-link-position-93' title='28个话题' style='font-size: 13.911111111111px;'>装饰器</a>
<a href='http://python.jobbole.com/tag/%e8%a7%a3%e9%87%8a%e5%99%a8/' class='tag-link-710 tag-link-position-94' title='7个话题' style='font-size: 9.5555555555556px;'>解释器</a>
<a href='http://python.jobbole.com/tag/%e8%b4%9d%e5%8f%b6%e6%96%af/' class='tag-link-825 tag-link-position-95' title='8个话题' style='font-size: 9.9444444444444px;'>贝叶斯</a>
<a href='http://python.jobbole.com/tag/%e8%bf%ad%e4%bb%a3%e5%99%a8/' class='tag-link-836 tag-link-position-96' title='12个话题' style='font-size: 11.188888888889px;'>迭代器</a>
<a href='http://python.jobbole.com/tag/%e9%81%97%e4%bc%a0%e7%ae%97%e6%b3%95/' class='tag-link-1541 tag-link-position-97' title='6个话题' style='font-size: 9.1666666666667px;'>遗传算法</a>
<a href='http://python.jobbole.com/tag/%e9%97%ad%e5%8c%85/' class='tag-link-885 tag-link-position-98' title='9个话题' style='font-size: 10.333333333333px;'>闭包</a>
<a href='http://python.jobbole.com/tag/%e9%9d%a2%e5%90%91%e5%af%b9%e8%b1%a1/' class='tag-link-861 tag-link-position-99' title='6个话题' style='font-size: 9.1666666666667px;'>面向对象</a>
<a href='http://python.jobbole.com/tag/%e9%9d%a2%e8%af%95/' class='tag-link-1037 tag-link-position-100' title='6个话题' style='font-size: 9.1666666666667px;'>面试</a></p></div></div><div id="text-12" class="widget widget_text">			<div class="textwidget"><p><a href="http://blog.jobbole.com/84342/" target="_blank"><img src="http://jbcdn2.b0.upaiyun.com/2016/08/74d126ea14f964e13bb07d24843bdab4.jpg" /></a></p>
</div>
		</div>            <h3 class="widget-title">
                <a href="http://hao.jobbole.com?catid=144&utm_source=python.jobbole.com&utm_medium=sidebar-resources-more" target="_blank">Python工具资源</a>
                <span style="float:right;"><a target="_blank" href="http://hao.jobbole.com?catid=144&utm_source=python.jobbole.com&utm_medium=sidebar-resources-more">更多资源 &raquo;</a></span>
            </h3>
            <div class="container">
                <div class="grid-4">
                
                    <div class="floated-thumb">
                        <div class="post-thumb">
                            <a target="_blank" href="http://hao.jobbole.com/tryton/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="Tryton：一个通用商务框架"><img src="http://jbcdn1.b0.upaiyun.com/2017/01/fbce31ffc19ced1422abbb0a860c5ab7.png" alt="" width="50" height="50" /></a>
                        </div>
                        <div class="post-meta">
                            <p>
                                <a class="meta-title" target="_blank" href="http://hao.jobbole.com/tryton/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="Tryton：一个通用商务框架">Tryton：一个通用商务框架</a><br />
                                <a href="http://hao.jobbole.com/category/python-tools/python-misc/" rel="category tag">杂项</a>
                            </p>
                        </div>
                        <div class="clear"></div>
                    </div>
                
                    <div class="floated-thumb">
                        <div class="post-thumb">
                            <a target="_blank" href="http://hao.jobbole.com/nltk/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="NLTK：一个先进的用来处理自然语言数据的Python程序。"><img src="http://jbcdn1.b0.upaiyun.com/2016/12/0384e39ce19622237039c4a86febccc9.png" alt="" width="50" height="50" /></a>
                        </div>
                        <div class="post-meta">
                            <p>
                                <a class="meta-title" target="_blank" href="http://hao.jobbole.com/nltk/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="NLTK：一个先进的用来处理自然语言数据的Python程序。">NLTK：一个先进的用来处理自然语言数据的Python程序。</a><br />
                                <a href="http://hao.jobbole.com/category/python-tools/python-natural-lang/" rel="category tag">自然语言处理</a> &middot; <a target='_blank' href='http://hao.jobbole.com/nltk/#comments'><i class='fa fa-comments-o'></i> 3</a>
                            </p>
                        </div>
                        <div class="clear"></div>
                    </div>
                
                    <div class="floated-thumb">
                        <div class="post-thumb">
                            <a target="_blank" href="http://hao.jobbole.com/pymc/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="PyMC：马尔科夫链蒙特卡洛采样工具"><img src="http://jbcdn1.b0.upaiyun.com/2016/12/bf6677dba678925802f3f1e76ec760c3.png" alt="" width="50" height="50" /></a>
                        </div>
                        <div class="post-meta">
                            <p>
                                <a class="meta-title" target="_blank" href="http://hao.jobbole.com/pymc/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="PyMC：马尔科夫链蒙特卡洛采样工具">PyMC：马尔科夫链蒙特卡洛采样工具</a><br />
                                <a href="http://hao.jobbole.com/category/python-tools/python-science-data-analysis/" rel="category tag">科学计算与分析</a>
                            </p>
                        </div>
                        <div class="clear"></div>
                    </div>
                
                    <div class="floated-thumb">
                        <div class="post-thumb">
                            <a target="_blank" href="http://hao.jobbole.com/statsmodels/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="statsmodels：统计建模和计量经济学"><img src="http://jbcdn1.b0.upaiyun.com/2016/12/e88a9784e92acb81d2f3c8331493e004.png" alt="" width="50" height="50" /></a>
                        </div>
                        <div class="post-meta">
                            <p>
                                <a class="meta-title" target="_blank" href="http://hao.jobbole.com/statsmodels/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="statsmodels：统计建模和计量经济学">statsmodels：统计建模和计量经济学</a><br />
                                <a href="http://hao.jobbole.com/category/python-tools/python-science-data-analysis/" rel="category tag">科学计算与分析</a>
                            </p>
                        </div>
                        <div class="clear"></div>
                    </div>
                
                    <div class="floated-thumb">
                        <div class="post-thumb">
                            <a target="_blank" href="http://hao.jobbole.com/pylearn2/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="Pylearn2：一个基于Theano的机器学习库"><img src="http://jbcdn1.b0.upaiyun.com/2016/12/660abdb1c0391cfc738b3266106119c9.png" alt="" width="50" height="50" /></a>
                        </div>
                        <div class="post-meta">
                            <p>
                                <a class="meta-title" target="_blank" href="http://hao.jobbole.com/pylearn2/?utm_source=python.jobbole.com&utm_medium=sidebar-resources" title="Pylearn2：一个基于Theano的机器学习库">Pylearn2：一个基于Theano的机器学习库</a><br />
                                <a href="http://hao.jobbole.com/category/python-tools/python-machine-learning/" rel="category tag">机器学习</a> &middot; <a target='_blank' href='http://hao.jobbole.com/pylearn2/#comments'><i class='fa fa-comments-o'></i> 1</a>
                            </p>
                        </div>
                        <div class="clear"></div>
                    </div>
                                </div>
            </div>
        	
	<!-- BEGIN .container -->
	<div class="container">
	
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<!-- BEGIN .grid-2 -->
		<div class="grid-2">
			
						
		</div>
		<!-- END .grid-2 -->
		
		<div class="clear"></div>
			
	</div>
	<!-- END .container -->

</div>
<!-- END #sidebar -->
<div class="clear"></div>	


</div>
<!-- END #wrapper -->

<!-- BEGIN footer -->

    <footer>

        <!-- BEGIN .container -->
        <div class="container">

            <!-- BEGIN .grid-4 -->
            <div class="grid-4">

                <div id="text-3" class="widget widget_text"><h3 class="widget-title">关于 Python 频道</h3>			<div class="textwidget"><p>Python频道分享 Python 开发技术、相关的行业动态。</p>
<p><b>快速链接</b><br />
<a target='_blank' href="http://blog.jobbole.com/87622/">网站使用指南 » </a><br />
<a target='_blank' href="http://group.jobbole.com/22422/">加入我们 » </a><br />
<a target='_blank' href="http://group.jobbole.com/category/feedback/thanks">问题反馈与求助 » </a><br />
<a target='_blank' href="http://group.jobbole.com/158/">网站积分规则 » </a><br />
<a target='_blank' href="http://group.jobbole.com/175/">网站声望规则 » </a></p>
</div>
		</div>
            </div>
            <!-- END .grid-4 -->

            <!-- BEGIN .grid-4 -->
            <div class="grid-4">

                <div id="text-5" class="widget widget_text"><h3 class="widget-title">关注我们</h3>			<div class="textwidget"><p>新浪微博：<a href='http://weibo.com/u/5305630013' target='_blank'>@Python开发者</a><br />
RSS：<a href='http://python.jobbole.com/feed/' target='_blank'>订阅地址</a><br />
推荐微信号<br />
<img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/Python_weixin.png' width='100' height='110' /><img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/Linux_weixin.png' width='100' height='110' /><img src='http://jbcdn2.b0.upaiyun.com/2015/12/weixin/db_weixin.png' width='100' height='110' /></p>
<p><strong>合作联系</strong><br />
Email：<a href='mailto:bd@jobbole.com'>bd@Jobbole.com</a><br />
QQ： 2302462408  （加好友请注明来意）</p>
</div>
		</div>
            </div>
            <!-- END .grid-4 -->

            <!-- BEGIN .grid-4 -->
            <div class="grid-4">

                <div id="text-4" class="widget widget_text"><h3 class="widget-title">更多频道</h3>			<div class="textwidget"><p><a href='http://group.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>小组</a> &#8211; 好的话题、有启发的回复、值得信赖的圈子<br />
<a href='http://top.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>头条</a> &#8211; 分享和发现有价值的内容与观点<br />
<a href='http://date.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>相亲</a> &#8211; 为IT单身男女服务的征婚传播平台<br />
<a href='http://hao.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>资源</a> &#8211; 优秀的工具资源导航<br />
<a href='http://fanyi.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>翻译</a> &#8211; 翻译传播优秀的外文文章<br />
<a href='http://blog.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>文章</a> &#8211; 国内外的精选文章<br />
<a href='http://design.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>设计</a> &#8211; UI,网页，交互和用户体验<br />
<a href='http://ios.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>iOS</a> &#8211; 专注iOS技术分享<br />
<a href='http://android.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>安卓</a> &#8211; 专注Android技术分享<br />
<a href='http://web.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>前端</a> &#8211; JavaScript, HTML5, CSS<br />
<a href='http://www.importnew.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>Java</a> &#8211; 专注Java技术分享<br />
<a href='http://python.jobbole.com/?utm_source=python.jobbole.com&#038;utm_medium=bottomText' target='_blank'>Python</a> &#8211; 专注Python技术分享</p>
</div>
		</div>
            </div>
            <!-- END .grid-4 -->

            <div class="clear"></div>

        </div>
        <!-- END .container -->

        <!-- BEGIN #bottom -->
        <div id="bottom">

            <!-- BEGIN .container -->
            <div class="container">

                <!-- BEGIN .grid-12 -->
                <div class="grid-12">

                    <p>&copy; 2018 伯乐在线
                    <span style="margin: 0 40px;">
                        <a href="http://blog.jobbole.com">文章</a>&nbsp;&nbsp;
                        <a href="http://group.jobbole.com">小组</a>&nbsp;&nbsp;
                        <a href="http://date.jobbole.com">相亲</a>&nbsp;&nbsp;
                        <a href="http://group.jobbole.com/22422/">加入我们</a>&nbsp;&nbsp;
                        <a href="http://group.jobbole.com/category/feedback/thanks/"><i class="fa fa-bullhorn"></i> 反馈</a>
                    </span>
                    <a target="_blank" href="http://www.miitbeian.gov.cn/publish/query/indexFirst.action">沪ICP备14046347号-1</a>
                    </p>
                </div>
                <!-- END .grid-12 -->

                <div class="clear"></div>

            </div>
            <!-- END .container -->

        </div>
        <!-- END #bottom -->
    </footer>

    
<!-- END footer -->



<script type='text/javascript'>
/* <![CDATA[ */
var thickboxL10n = {"next":"\u4e0b\u4e00\u9875 >","prev":"< \u4e0a\u4e00\u9875","image":"\u56fe\u50cf","of":"\/","close":"\u5173\u95ed","noiframes":"\u8fd9\u4e2a\u529f\u80fd\u9700\u8981iframe\u7684\u652f\u6301\u3002\u60a8\u53ef\u80fd\u7981\u6b62\u4e86iframe\u7684\u663e\u793a\uff0c\u6216\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u6b64\u529f\u80fd\u3002","loadingAnimation":"http:\/\/python.jobbole.com\/wp-includes\/js\/thickbox\/loadingAnimation.gif"};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/thickbox/thickbox.js?ver=3.1-20121105'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/underscore.min.js?ver=1.8.3'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/shortcode.min.js?ver=4.5.13'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-admin/js/media-upload.min.js?ver=4.5.13'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/comment-reply.min.js?ver=4.5.13'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"\u5173\u95ed\u6240\u6709\u6253\u5f00\u7684\u6807\u7b7e","closeTags":"\u5173\u95ed\u6807\u7b7e","enterURL":"\u8f93\u5165URL","enterImageURL":"\u8f93\u5165\u56fe\u50cfURL","enterImageDescription":"\u4e3a\u56fe\u50cf\u8f93\u5165\u63cf\u8ff0","textdirection":"\u6587\u672c\u65b9\u5411","toggleTextdirection":"\u5207\u6362\u7f16\u8f91\u5668\u6587\u672c\u4e66\u5199\u65b9\u5411","dfw":"\u514d\u6253\u6270\u5199\u4f5c\u6a21\u5f0f","strong":"\u7c97\u4f53","strongClose":"\u5173\u95ed\u7c97\u4f53\u6807\u7b7e","em":"\u659c\u4f53","emClose":"\u5173\u95ed\u659c\u4f53\u6807\u7b7e","link":"\u63d2\u5165\u94fe\u63a5","blockquote":"\u5757\u5f15\u7528","blockquoteClose":"\u5173\u95ed\u5757\u5f15\u7528\u6807\u7b7e","del":"\u5220\u9664\u7684\u6587\u5b57\uff08\u5220\u9664\u7ebf\uff09","delClose":"\u5173\u95ed\u5220\u9664\u7ebf\u6807\u7b7e","ins":"\u63d2\u5165\u7684\u6587\u5b57","insClose":"\u5173\u95ed\u63d2\u5165\u7684\u6587\u5b57\u6807\u7b7e","image":"\u63d2\u5165\u56fe\u50cf","ul":"\u9879\u76ee\u7b26\u53f7\u5217\u8868","ulClose":"\u5173\u95ed\u9879\u76ee\u7b26\u53f7\u5217\u8868\u6807\u7b7e","ol":"\u7f16\u53f7\u5217\u8868","olClose":"\u5173\u95ed\u7f16\u53f7\u5217\u8868\u6807\u7b7e","li":"\u5217\u8868\u9879\u76ee","liClose":"\u5173\u95ed\u5217\u8868\u9879\u76ee\u6807\u7b7e","code":"\u4ee3\u7801","codeClose":"\u5173\u95ed\u4ee3\u7801\u6807\u7b7e","more":"\u63d2\u5165\u201cMore\u201d\u6807\u7b7e"};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/quicktags.min.js?ver=4.5.13'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/crayon-syntax-highlighter/util/tag-editor/crayon_qt.js?ver=2.7.1.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var viewsCacheL10n = {"admin_ajax_url":"http:\/\/python.jobbole.com\/wp-admin\/admin-ajax.php","post_id":"86584"};
/* ]]> */
</script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/plugins/wp-postviews/postviews-cache.js?ver=1.68'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/ready.js?ver=1.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/easing.js?ver=1.3'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/validate.js?ver=1.9.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/touchwipe.js?ver=1.1.1'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/caroufredsel.js?ver=5.5.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/flexslider.js?ver=2.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/jplayer.js?ver=2.1.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/fitvids.js?ver=1.0'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/selectnav.js?ver=0.11'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/js/effects.js?ver=1.11'></script>
<script type='text/javascript' src='http://python.jobbole.com/wp-includes/js/wp-embed.min.js?ver=4.5.13'></script>


<div id="full-btm">
<a><img src="http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/img/back-btm.png" width="20" border=0 alt="跳到底部" title="跳到底部"></a>
</div>

<script type="text/javascript">
jQuery('#full-btm').click(function(){
    jQuery('html, body').animate({scrollTop:jQuery(document).height()}, 'slow');
    return false;
});
</script>

<div id="full-top">
<a><img src="http://python.jobbole.com/wp-content/themes/jobboleblogv3/_assets/img/back-top.png" width="20" border=0 alt="返回顶部" title="返回顶部"></a>
</div>

<script type="text/javascript">
jQuery('#full-top').click(function(){
    jQuery('html, body').animate({scrollTop:0}, 'slow');
    return false;
});

</script>

</body>
<!-- END body -->

</html>
<!-- END html -->